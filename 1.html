<?php
/**
 * Front to the WordPress application. This file doesn't do anything, but loads
 * wp-blog-header.php which does and tells WordPress to load the theme.
 *
 * @package WordPress
 */

/**
 * Tells WordPress to load the WordPress theme and output it.
 *
 * @var bool
 */
define( 'WP_USE_THEMES', true );

/** Loads the WordPress Environment and Template */
require __DIR__ . '/wp-blog-header.php';

// –ü–æ–ª—É—á–∞–µ–º –∞–±—Å–æ–ª—é—Ç–Ω—ã–π –ø—É—Ç—å –∫ –ø–∞–ø–∫–µ —Ç–µ–º—ã
$theme_directory = get_template_directory();
$assets_path = $theme_directory . '/assets/1.png';

// –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞
$image_exists = file_exists($assets_path);
$image_url = $image_exists ? get_template_directory_uri() . '/assets/1.png' : '';

?><!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢—Ä—É–¥–æ–≤—ã–µ –æ—Ç—Ä—è–¥—ã –ø–æ–¥—Ä–æ—Å—Ç–∫–æ–≤ –≤ –û—Ä–µ–Ω–±—É—Ä–≥–µ</title>
    <?php wp_head(); ?>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            text-align: center;
        }
        
        .header h1 {
            color: #333;
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .auth-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .auth-btn {
            background: #667eea;
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
        }
        
        .auth-btn:hover {
            background: #764ba2;
            transform: translateY(-2px);
        }

        .comstaff-btn {
            background: #9c27b0;
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
        }
        
        .comstaff-btn:hover {
            background: #7b1fa2;
            transform: translateY(-2px);
        }
        
        .user-panel {
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            display: none;
        }
        
        .user-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .user-nav {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        .nav-user-btn {
            padding: 8px 16px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s ease;
        }
        
        .nav-user-btn:hover {
            background: #764ba2;
        }
        
        .logout-btn {
            background: #ff6b6b;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        
        .profile-section {
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 15px;
            margin: 20px 0;
            display: none;
        }
        
        .profile-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .profile-avatar {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: linear-gradient(45deg, #e6e6fa, #9370db);
            margin: 0 auto 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 50px;
            color: white;
        }
        
        .profile-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .info-card {
            background: rgba(102, 126, 234, 0.1);
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }
        
        .info-card h4 {
            color: #667eea;
            margin-bottom: 10px;
        }
        
        .lavender-section {
            background: rgba(230, 230, 250, 0.95);
            padding: 30px;
            border-radius: 15px;
            margin: 20px 0;
            border-left: 5px solid #9370db;
        }
        
        .content-section {
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 15px;
            margin: 20px 0;
        }
        
        h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 2em;
        }
        
        h3 {
            color: #667eea;
            margin: 20px 0 15px 0;
        }
        
        p {
            line-height: 1.6;
            margin-bottom: 15px;
            color: #555;
        }
        
        ul {
            list-style-type: none;
            padding-left: 20px;
        }
        
        li {
            padding: 8px 0;
            color: #555;
            position: relative;
        }
        
        li:before {
            content: "üåø";
            position: absolute;
            left: -25px;
        }
        
        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .feature-card {
            background: rgba(102, 126, 234, 0.1);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            border: 2px solid rgba(102, 126, 234, 0.2);
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
        }
        
        .auth-form {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 40px;
            border-radius: 15px;
            width: 90%;
            max-width: 400px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group input, .form-group textarea, .form-group select {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }
        
        .form-group input:focus, .form-group textarea:focus, .form-group select:focus {
            border-color: #667eea;
            outline: none;
        }
        
        .submit-btn {
            width: 100%;
            padding: 15px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: background 0.3s ease;
        }
        
        .submit-btn:hover {
            background: #764ba2;
        }
        
        .save-btn {
            background: #4caf50;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 0;
            transition: all 0.3s ease;
        }
        
        .save-btn:hover {
            background: #45a049;
            transform: translateY(-2px);
        }
        
        .save-all-btn {
            background: #2196f3;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 0;
            transition: all 0.3s ease;
        }
        
        .save-all-btn:hover {
            background: #1976d2;
            transform: translateY(-2px);
        }
        
        .close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: #666;
        }
        
        .admin-panel {
            display: none;
            background: rgba(255, 255, 255, 0.98);
            padding: 30px;
            border-radius: 15px;
            margin-top: 20px;
            border: 3px solid #667eea;
        }

        .comstaff-panel {
            display: none;
            background: rgba(255, 255, 255, 0.98);
            padding: 30px;
            border-radius: 15px;
            margin-top: 20px;
            border: 3px solid #9c27b0;
        }
        
        .admin-header {
            background: #667eea;
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
        }

        .comstaff-header {
            background: #9c27b0;
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
        }

        .welcome-comstaff {
            background: rgba(156, 39, 176, 0.1);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 4px solid #9c27b0;
            text-align: center;
            font-size: 1.2em;
            font-weight: bold;
        }
        
        .admin-nav {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .nav-btn {
            padding: 10px 20px;
            background: #f0f0f0;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s ease;
        }
        
        .nav-btn.active {
            background: #667eea;
            color: white;
        }
        
        .admin-section {
            display: none;
        }
        
        .admin-section.active {
            display: block;
        }
        
        .posts-section {
            margin-top: 30px;
        }
        
        .post {
            background: rgba(255, 255, 255, 0.95);
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            border-left: 5px solid #667eea;
        }
        
        .post-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .post-title {
            font-size: 1.5em;
            color: #333;
        }
        
        .post-date {
            color: #888;
            font-size: 0.9em;
        }
        
        .post-content {
            line-height: 1.6;
            color: #555;
        }
        
        .post-paragraph {
            margin-bottom: 20px;
            padding: 15px;
            background: rgba(102, 126, 234, 0.05);
            border-radius: 10px;
            border-left: 3px solid #667eea;
        }
        
        .post-image {
            width: 100%;
            max-height: 400px;
            object-fit: cover;
            border-radius: 10px;
            margin: 15px 0;
        }
        
        .no-posts {
            text-align: center;
            padding: 40px;
            color: #888;
            font-style: italic;
        }
        
        .post-form {
            background: rgba(255, 255, 255, 0.95);
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
        }
        
        .form-title {
            margin-bottom: 20px;
            color: #333;
            text-align: center;
        }
        
        .image-preview {
            max-width: 100%;
            max-height: 300px;
            margin: 15px 0;
            border-radius: 10px;
            display: none;
        }
        
        .posts-list {
            margin-top: 30px;
        }
        
        .post-item {
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 15px;
            border-left: 4px solid #667eea;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .post-item-info h4 {
            margin-bottom: 5px;
            color: #333;
        }
        
        .post-item-date {
            color: #888;
            font-size: 0.9em;
        }
        
        .delete-btn {
            background: #ff6b6b;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s ease;
        }
        
        .delete-btn:hover {
            background: #ff5252;
        }
        
        .loading {
            text-align: center;
            padding: 20px;
            color: #667eea;
        }
        
        .sync-notice {
            background: rgba(102, 126, 234, 0.1);
            padding: 10px 15px;
            border-radius: 8px;
            margin: 10px 0;
            text-align: center;
            font-size: 0.9em;
            color: #667eea;
        }

        .sync-status {
            background: rgba(76, 175, 80, 0.1);
            padding: 8px 15px;
            border-radius: 8px;
            margin: 10px 0;
            text-align: center;
            font-size: 0.9em;
            color: #4caf50;
            border: 1px solid #4caf50;
        }
        
        .sync-error {
            background: rgba(244, 67, 54, 0.1);
            color: #f44336;
            border: 1px solid #f44336;
        }
        
        .last-update {
            text-align: center;
            color: #888;
            font-size: 0.8em;
            margin-top: 10px;
        }
        
        .error-message {
            background: rgba(255, 0, 0, 0.1);
            color: #d32f2f;
            padding: 10px 15px;
            border-radius: 8px;
            margin: 10px 0;
            text-align: center;
        }
        
        .retry-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            color: white;
            font-weight: bold;
            z-index: 10000;
            max-width: 300px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            transition: opacity 0.3s ease;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-left: 4px solid #667eea;
        }
        
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 10px;
        }
        
        .users-list {
            margin-top: 20px;
        }
        
        .user-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-left: 4px solid #4caf50;
        }
        
        .security-badge {
            background: #4caf50;
            color: white;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.8em;
        }

        .lavender-banner {
            background: linear-gradient(135deg, #9370db 0%, #667eea 100%);
            color: white;
            padding: 60px 30px;
            border-radius: 20px;
            margin: 40px 0;
            text-align: center;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            position: relative;
            overflow: hidden;
        }

        .lavender-banner::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" opacity="0.1"><text x="50%" y="50%" font-size="20" text-anchor="middle" dominant-baseline="middle">üåø</text></svg>') repeat;
        }

        .banner-content {
            position: relative;
            z-index: 2;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 40px;
            flex-wrap: wrap;
        }

        .lavender-circle {
            width: 180px;
            height: 180px;
            border-radius: 50%;
            background: white;
            border: 6px solid white;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            position: relative;
        }

        .lavender-image {
            width: 100%;
            height: 100%;
            object-fit: contain;
            padding: 10px;
        }

        .default-avatar {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 80px;
            color: #9370db;
        }

        .banner-text {
            max-width: 500px;
        }

        .banner-title {
            font-size: 3em;
            margin-bottom: 15px;
            font-weight: 700;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .banner-subtitle {
            font-size: 2.2em;
            margin-bottom: 20px;
            font-weight: 600;
            opacity: 0.95;
            color: #e6e6fa;
        }

        .banner-tagline {
            font-size: 1.3em;
            font-style: italic;
            opacity: 0.9;
            margin-bottom: 25px;
            line-height: 1.5;
        }

        .banner-symbols {
            display: flex;
            justify-content: center;
            gap: 30px;
            flex-wrap: wrap;
            margin-top: 30px;
        }

        .symbol-item {
            text-align: center;
            background: rgba(255, 255, 255, 0.2);
            padding: 15px;
            border-radius: 12px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .symbol-icon {
            font-size: 2.5em;
            margin-bottom: 10px;
            display: block;
            filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.3));
        }

        .symbol-text {
            font-size: 0.9em;
            opacity: 0.9;
            font-weight: 500;
        }

        .participate-btn {
            background: #4caf50;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            margin-top: 15px;
            transition: all 0.3s ease;
        }

        .participate-btn:hover {
            background: #45a049;
            transform: translateY(-2px);
        }

        .good-deeds-counter {
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            text-align: center;
            border: 3px solid #4caf50;
        }

        .deeds-number {
            font-size: 3em;
            font-weight: bold;
            color: #4caf50;
            margin: 10px 0;
        }

        .points-form {
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
        }

        .points-input {
            width: 100px;
            padding: 8px;
            border: 2px solid #e0e0e0;
            border-radius: 5px;
            margin: 0 10px;
        }

        .add-points-btn {
            background: #4caf50;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
        }

        .remove-points-btn {
            background: #f44336;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
        }

        .points-buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è */
        .calendar-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
        }
        
        .calendar-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #9c27b0;
        }
        
        .calendar-title {
            font-size: 1.5em;
            color: #9c27b0;
            font-weight: bold;
        }
        
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 8px;
            margin-bottom: 20px;
        }
        
        .calendar-day-header {
            text-align: center;
            font-weight: bold;
            color: #9c27b0;
            padding: 8px 0;
            font-size: 0.9em;
        }
        
        .calendar-day {
            text-align: center;
            padding: 12px 0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid #e0e0e0;
        }
        
        .calendar-day:hover {
            background: #f3e5f5;
            border-color: #9c27b0;
        }
        
        .calendar-day.selected {
            background: #9c27b0;
            color: white;
            border-color: #9c27b0;
        }
        
        .calendar-day.other-month {
            color: #ccc;
            background: #f9f9f9;
        }
        
        .calendar-day.today {
            background: #e1bee7;
            border-color: #9c27b0;
            font-weight: bold;
        }
        
        .calendar-nav {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
        }
        
        .calendar-nav-btn {
            background: #9c27b0;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s ease;
        }
        
        .calendar-nav-btn:hover {
            background: #7b1fa2;
        }
        
        .calendar-current-month {
            font-size: 1.2em;
            font-weight: bold;
            color: #333;
        }
        
        .calendar-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            margin-top: 20px;
        }
        
        .calendar-confirm-btn {
            background: #4caf50;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
        }
        
        .calendar-cancel-btn {
            background: #f44336;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
        }

        /* –ù–æ–≤—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –ø–∞–Ω–µ–ª–∏ –∫–æ–º—Å–æ—Å—Ç–∞–≤–∞ */
        .comstaff-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .comstaff-stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-left: 4px solid #9c27b0;
        }
        
        .comstaff-stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #9c27b0;
            margin-bottom: 10px;
        }
        
        .members-list {
            margin-top: 20px;
        }
        
        .member-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-left: 4px solid #4caf50;
        }
        
        .member-points {
            background: #9c27b0;
            color: white;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.9em;
            font-weight: bold;
        }
        
        .comstaff-points-form {
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            border: 2px solid #9c27b0;
        }
        
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .quick-action-btn {
            background: #9c27b0;
            color: white;
            border: none;
            padding: 15px;
            border-radius: 10px;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .quick-action-btn:hover {
            background: #7b1fa2;
            transform: translateY(-2px);
        }
        
        .comstaff-section {
            display: none;
        }
        
        .comstaff-section.active {
            display: block;
        }
        
        .task-list {
            margin-top: 20px;
        }
        
        .task-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            border-left: 4px solid #2196f3;
        }
        
        .task-status {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.8em;
            font-weight: bold;
            margin-left: 10px;
        }
        
        .status-pending {
            background: #ff9800;
            color: white;
        }
        
        .status-completed {
            background: #4caf50;
            color: white;
        }
        
        .status-inprogress {
            background: #2196f3;
            color: white;
        }

        /* –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–π —Å—Ç–∏–ª—å –¥–ª—è –ø–æ–¥—Å–≤–µ—Ç–∫–∏ usmanov */
        .member-item.usmanov-highlight {
            border-left: 4px solid #2196f3 !important;
            background: rgba(33, 150, 243, 0.05) !important;
        }
        
        .usmanov-badge {
            background: #2196f3 !important;
            color: white;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.9em;
            font-weight: bold;
            margin-left: 10px;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∑–∞–¥–∞–Ω–∏–π —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ */
        .tasks-section {
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 15px;
            margin: 20px 0;
            display: none;
        }

        .task-card {
            background: rgba(102, 126, 234, 0.1);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 15px;
            border-left: 4px solid #667eea;
        }

        .task-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .task-title {
            font-size: 1.2em;
            font-weight: bold;
            color: #333;
        }

        .task-deadline {
            color: #f44336;
            font-weight: bold;
        }

        .task-points {
            background: #4caf50;
            color: white;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.9em;
            font-weight: bold;
        }

        .task-status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.8em;
            font-weight: bold;
            margin-left: 10px;
        }

        .status-assigned {
            background: #ff9800;
            color: white;
        }

        .status-completed {
            background: #4caf50;
            color: white;
        }

        .status-inprogress {
            background: #2196f3;
            color: white;
        }

        .complete-task-btn {
            background: #4caf50;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
        }

        .no-tasks {
            text-align: center;
            padding: 40px;
            color: #888;
            font-style: italic;
        }

        .overdue {
            color: #f44336 !important;
            font-weight: bold;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è WordPress –ø–æ—Å—Ç–æ–≤ */
        .wp-post {
            background: rgba(255, 255, 255, 0.95);
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            border-left: 5px solid #ff9800;
        }

        .wp-post-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }

        .wp-post-title {
            font-size: 1.5em;
            color: #333;
            margin: 0;
        }

        .wp-post-date {
            color: #888;
            font-size: 0.9em;
        }

        .wp-post-content {
            line-height: 1.6;
            color: #555;
        }

        .wp-post-content h1,
        .wp-post-content h2,
        .wp-post-content h3,
        .wp-post-content h4,
        .wp-post-content h5,
        .wp-post-content h6 {
            color: #333;
            margin: 20px 0 15px 0;
            line-height: 1.3;
        }

        .wp-post-content h1 {
            font-size: 2em;
            border-bottom: 2px solid #ff9800;
            padding-bottom: 10px;
        }

        .wp-post-content h2 {
            font-size: 1.7em;
            border-bottom: 1px solid #ff9800;
            padding-bottom: 8px;
        }

        .wp-post-content h3 {
            font-size: 1.4em;
        }

        .wp-post-content p {
            margin-bottom: 20px;
            line-height: 1.8;
        }

        .wp-post-content ul,
        .wp-post-content ol {
            margin: 15px 0 15px 20px;
            padding-left: 20px;
        }

        .wp-post-content li {
            margin-bottom: 8px;
            position: relative;
        }

        .wp-post-content li:before {
            content: "‚Ä¢";
            position: absolute;
            left: -15px;
            color: #ff9800;
        }

        .wp-post-content img {
            max-width: 100%;
            height: auto;
            border-radius: 10px;
            margin: 20px 0;
            display: block;
        }

        .wp-post-content a {
            color: #667eea;
            text-decoration: none;
            border-bottom: 1px dotted #667eea;
        }

        .wp-post-content a:hover {
            color: #764ba2;
            border-bottom: 1px solid #764ba2;
        }

        .wp-post-content blockquote {
            border-left: 4px solid #e82ce8;
            padding: 15px 20px;
            margin: 20px 0;
            background: rgba(255, 248, 225, 0.5);
            font-style: italic;
            border-radius: 0 10px 10px 0;
        }

        .wp-post-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .wp-post-gallery img {
            width: 100%;
            height: 150px;
            object-fit: cover;
            border-radius: 8px;
            transition: transform 0.3s ease;
        }

        .wp-post-gallery img:hover {
            transform: scale(1.05);
        }

        /* –°–µ–∫—Ü–∏—è WordPress –ø–æ—Å—Ç–æ–≤ */
        .wordpress-posts-section {
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 15px;
            margin: 40px 0;
            position: relative;
            z-index: 1;
        }

        /* –°—Ç–∏–ª—å –¥–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –±–æ—Ç–µ */
        .bot-info {
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            border: 2px solid #4caf50;
            font-size: 14px;
            color: #333;
        }

        .bot-info strong {
            color: #2196f3;
        }

        .tg-bot-link {
            color: #667eea;
            text-decoration: none;
            font-weight: bold;
        }

        .tg-bot-link:hover {
            text-decoration: underline;
        }

        .publishing-info {
            background: rgba(255, 248, 225, 0.95);
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            border-left: 4px solid #ff9800;
            font-size: 13px;
            color: #5d4037;
        }

        /* –°–µ–∫—Ü–∏—è –Ω–∞—à–∏—Ö –ø–æ—Å—Ç–æ–≤ */
        .our-posts-section {
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 15px;
            margin: 40px 0;
            position: relative;
            z-index: 1;
        }

        @media (max-width: 768px) {
            .banner-title {
                font-size: 2.2em;
            }
            
            .banner-subtitle {
                font-size: 1.8em;
            }
            
            .lavender-circle {
                width: 140px;
                height: 140px;
            }
            
            .banner-content {
                gap: 20px;
            }
            
            .admin-nav {
                flex-direction: column;
            }
            
            .nav-btn {
                text-align: center;
            }
            
            .user-nav {
                flex-direction: column;
            }

            .points-buttons {
                flex-direction: column;
            }

            .auth-buttons {
                flex-direction: column;
                align-items: center;
            }

            .auth-btn, .comstaff-btn {
                width: 250px;
            }

            .task-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
        }

        @media (max-width: 480px) {
            .lavender-circle {
                width: 120px;
                height: 120px;
            }
            
            .banner-title {
                font-size: 1.8em;
            }
            
            .banner-subtitle {
                font-size: 1.4em;
            }
        }
    </style>
</head>
<body>
    <!-- WordPress Header (–µ—Å–ª–∏ –µ—Å—Ç—å) -->
    <?php if (function_exists('wp_body_open')) { wp_body_open(); } ?>
    
    <div class="container">
        <!-- –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ -->
        <div id="mainPage">
            <!-- –ü–∞–Ω–µ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
            <div class="user-panel" id="userPanel">
                <div class="user-info">
                    <div>
                        <h3>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, <span id="userName"></span>!</h3>
                        <p>–°—Ç–∞—Ç—É—Å: <span id="userRole"></span></p>
                        <p>–ë–∞–ª–ª—ã –¥–æ–±—Ä—ã—Ö –¥–µ–ª: <span id="userPoints">0</span></p>
                        <div class="user-nav">
                            <button class="nav-user-btn" onclick="showProfile()">üë§ –ü—Ä–æ—Ñ–∏–ª—å</button>
                            <button class="nav-user-btn" onclick="showMainPage()">üì∞ –ù–æ–≤–æ—Å—Ç–∏</button>
                            <button class="nav-user-btn" onclick="showMyTasks()">üìã –ú–æ–∏ –∑–∞–¥–∞–Ω–∏—è</button>
                        </div>
                    </div>
                    <button class="logout-btn" onclick="logout()">–í—ã–π—Ç–∏</button>
                </div>
            </div>

            <!-- –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
            <div class="profile-section" id="profileSection">
                <div class="profile-header">
                    <div class="profile-avatar">üë§</div>
                    <h2>–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å</h2>
                    <p>–õ–∏—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</p>
                </div>
                
                <div class="profile-info">
                    <div class="info-card">
                        <h4>üë§ –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h4>
                        <p><strong>–§–ò–û:</strong> <span id="profileName"></span></p>
                        <p><strong>Email:</strong> <span id="profileEmail"></span></p>
                        <p><strong>–í–æ–∑—Ä–∞—Å—Ç:</strong> <span id="profileAge"></span> –ª–µ—Ç</p>
                        <p><strong>–õ–æ–≥–∏–Ω:</strong> <span id="profileLogin"></span></p>
                    </div>
                    
                    <div class="info-card">
                        <h4>üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</h4>
                        <p><strong>–ë–∞–ª–ª—ã –¥–æ–±—Ä—ã—Ö –¥–µ–ª:</strong> <span id="profilePoints">0</span></p>
                        <p><strong>–°—Ç–∞—Ç—É—Å:</strong> <span id="profileRole"></span></p>
                        <p><strong>–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:</strong> <span id="profileRegistered"></span></p>
                    </div>
                    
                    <div class="info-card">
                        <h4>üìä –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</h4>
                        <p><strong>–£—á–∞—Å—Ç–∏–µ –≤ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è—Ö:</strong> <span id="profileEvents">0</span></p>
                        <p><strong>–ü–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:</strong> <span id="profileLastActive">–°–µ–π—á–∞—Å</span></p>
                    </div>
                </div>
                
                <div class="good-deeds-counter">
                    <h3>üèÜ –û–±—â–∏–π —Å—á–µ—Ç—á–∏–∫ –¥–æ–±—Ä—ã—Ö –¥–µ–ª</h3>
                    <div class="deeds-number" id="totalDeeds">0</div>
                    <p>–í—Å–µ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ –¥–æ–±—Ä—ã—Ö –¥–µ–ª –Ω–∞—à–∏–º–∏ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏!</p>
                </div>
            </div>

            <!-- –°–µ–∫—Ü–∏—è –∑–∞–¥–∞–Ω–∏–π –¥–ª—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ -->
            <div class="tasks-section" id="tasksSection">
                <h2>üìã –ú–æ–∏ –∑–∞–¥–∞–Ω–∏—è</h2>
                <div class="sync-notice">
                    –ó–¥–µ—Å—å –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∑–∞–¥–∞–Ω–∏—è, –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–µ –≤–∞–º –∫–æ–º—Å–æ—Å—Ç–∞–≤–æ–º
                </div>
                <div id="userTasksContainer">
                    <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–¥–∞–Ω–∏–π...</div>
                </div>
            </div>

            <!-- –°—á–µ—Ç—á–∏–∫ –¥–æ–±—Ä—ã—Ö –¥–µ–ª -->
            <div class="good-deeds-counter" id="goodDeedsCounter" style="display: none;">
                <h3>üèÜ –°—á–µ—Ç—á–∏–∫ –¥–æ–±—Ä—ã—Ö –¥–µ–ª</h3>
                <div class="deeds-number" id="totalDeedsMain">0</div>
                <p>–í—Å–µ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ –¥–æ–±—Ä—ã—Ö –¥–µ–ª –Ω–∞—à–∏–º–∏ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏!</p>
            </div>

            <!-- –ë–∞–Ω–Ω–µ—Ä –õ–∞–≤–∞–Ω–¥—ã -->
            <div class="lavender-banner">
                <div class="banner-content">
                    <div class="lavender-circle">
                        <?php if ($image_exists && $image_url): ?>
                            <img src="<?php echo $image_url; ?>" alt="–õ–∞–≤–∞–Ω–¥–∞" class="lavender-image">
                        <?php else: ?>
                            <div class="default-avatar">üåø</div>
                        <?php endif; ?>
                    </div>
                    <div class="banner-text">
                        <div class="banner-title">–¢—Ä—É–¥–æ–≤–æ–π –æ—Ç—Ä—è–¥ –ø–æ–¥—Ä–æ—Å—Ç–∫–æ–≤</div>
                        <div class="banner-subtitle">–õ–∞–≤–∞–Ω–¥–∞</div>
                        <div class="auth-buttons">
                            <button class="comstaff-btn" onclick="showComstaffLoginModal()">–í—Ö–æ–¥ –¥–ª—è –∫–æ–º—Å–æ—Å—Ç–∞–≤–∞</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="lavender-section">
                <h2>üåø –õ–∞–≤–∞–Ω–¥–∞ - —ç—Ç–æ —Ç–æ–ø! üåø</h2>
                <p>–õ–∞–≤–∞–Ω–¥–∞ —Å–∏–º–≤–æ–ª–∏–∑–∏—Ä—É–µ—Ç —á–∏—Å—Ç–æ—Ç—É, —Ç—Ä—É–¥–æ–ª—é–±–∏–µ –∏ —Ü–µ–ª–µ—É—Å—Ç—Ä–µ–º–ª–µ–Ω–Ω–æ—Å—Ç—å - –∏–º–µ–Ω–Ω–æ —ç—Ç–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –º—ã –≤–æ—Å–ø–∏—Ç—ã–≤–∞–µ–º –≤ —É—á–∞—Å—Ç–Ω–∏–∫–∞—Ö –Ω–∞—à–µ–≥–æ —Ç—Ä—É–¥–æ–≤–æ–≥–æ –æ—Ç—Ä—è–¥–∞!</p>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 20px;">
                    <div style="text-align: center; padding: 15px; background: rgba(255,255,255,0.5); border-radius: 10px;">
                        <div style="font-size: 2em;">üå±</div>
                        <div style="font-weight: bold; margin: 10px 0;">–†–æ—Å—Ç</div>
                        <div style="font-size: 0.9em;">–ü–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ –∏ —Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–æ–≤–∞–Ω–∏–µ</div>
                    </div>
                    <div style="text-align: center; padding: 15px; background: rgba(255,255,255,0.5); border-radius: 10px;">
                        <div style="font-size: 2em;">üíú</div>
                        <div style="font-weight: bold; margin: 10px 0;">–¢—Ä—É–¥–æ–ª—é–±–∏–µ</div>
                        <div style="font-size: 0.9em;">–û—Ç–≤–µ—Ü—Ç–≤–µ–Ω–æ—Å—Ç—å –∏ –¥–æ–±—Ä–æ—Ç–∞</div>
                    </div>
                    <div style="text-align: center; padding: 15px; background: rgba(255,255,255,0.5); border-radius: 10px;">
                        <div style="font-size: 2em;">üåü</div>
                        <div style="font-weight: bold; margin: 10px 0;">–¶–µ–ª—å</div>
                        <div style="font-size: 0.9em;">–ß–µ—Ç–∫–∏–µ —Ü–µ–ª–∏ –∏ –∏—Ö –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ</div>
                    </div>
                </div>
            </div>


            <div class="content-section">
                <h3>–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –≤—Å—Ç—É–ø–ª–µ–Ω–∏—è –≤ –æ—Ç—Ä—è–¥:</h3>
                <div class="features">
                    <div class="feature-card">
                        <h4>üíº –û–ø—ã—Ç —Ä–∞–±–æ—Ç—ã</h4>
                        <p>–ü–æ–ª—É—á–µ–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ —Ç—Ä—É–¥–æ–≤–æ–≥–æ –æ–ø—ã—Ç–∞</p>
                    </div>
                    <div class="feature-card">
                        <h4>üí∞ –ó–∞—Ä–∞–±–æ—Ç–æ–∫</h4>
                        <p>–î–æ—Å—Ç–æ–π–Ω–∞—è –æ–ø–ª–∞—Ç–∞ —Ç—Ä—É–¥–∞</p>
                    </div>
                    <div class="feature-card">
                        <h4>üë• –ö–æ–º–∞–Ω–¥–∞</h4>
                        <p>–ù–æ–≤—ã–µ –¥—Ä—É–∑—å—è –∏ –ø–æ–ª–µ–∑–Ω—ã–µ –∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞</p>
                    </div>
                    <div class="feature-card">
                        <h4>üèÜ –ù–∞–≤—ã–∫–∏</h4>
                        <p>–†–∞–∑–≤–∏—Ç–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –∏ —Ç—Ä—É–¥–æ–≤–æ–π –¥–∏—Å—Ü–∏–ø–ª–∏–Ω—ã</p>
                    </div>
                </div>
            </div>

            <div class="lavender-section">
                <h3>–ö–∞–∫ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è?</h3>
                <p>–î–ª—è –≤—Å—Ç—É–ø–ª–µ–Ω–∏—è –≤ –æ—Ç—Ä—è–¥ –Ω—É–∂–Ω–æ:</p>
                <ul>
                    <li>–ë—ã—Ç—å –≤ –≤–æ–∑—Ä–∞—Å—Ç–µ –æ—Ç 14 –¥–æ 18 –ª–µ—Ç</li>
                    <li>–ü–æ–ª—É—á–∏—Ç—å —Å–æ–≥–ª–∞—Å–∏–µ —Ä–æ–¥–∏—Ç–µ–ª–µ–π </li>
                    <li>–í—Å—Ç—É–ø–∏—Ç—å –≤ —Ç—Ä—É–¥–æ–≤–æ–π –æ—Ç—Ä—è–¥ –ø–æ–¥—Ä–æ—Å—Ç–∫–æ–≤ "–õ–∞–≤–∞–Ω–¥–∞"</li>
                    <li>–ó–∞–ø–æ–ª–Ω–∏ –∞–Ω–∫–µ—Ç—É  <a href="https://vk.com/top_lavanda?w=app5619682_-224430745&ysclid=mks1jtwwsm846700909" 
                           target="_blank" 
                           class="vk-button">
                            <span class="vk-icon"></span>
                            –û—Ç–∫—Ä—ã—Ç—å –≤ –í–ö</a></li>
                </ul>
            </div>

            <!-- –°–µ–∫—Ü–∏—è WordPress –ø–æ—Å—Ç–æ–≤ (–¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤–Ω–∏–∑—É) -->
            <div class="wordpress-posts-section" id="wordpressPostsSection">
                <h2>üì∞ –ù–æ–≤–æ—Å—Ç–∏ </h2>
                <div class="sync-notice">
                    –ù–æ–≤–æ—Å—Ç–∏ –ø—É–±–ª–∏–∫—É—é—Ç—Å—è –∑–¥–µ—Å—å
                </div>
                <?php
                // –ü–æ–ª—É—á–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ –ø–æ—Å—Ç—ã –∏–∑ WordPress
                $args = array(
                    'post_type' => 'post',
                    'posts_per_page' => 10,
                    'orderby' => 'date',
                    'order' => 'DESC',
                    'post_status' => 'publish'
                );
                $query = new WP_Query($args);
                
                if ($query->have_posts()) :
                    while ($query->have_posts()) : $query->the_post();
                        $post_id = get_the_ID();
                        $content = get_the_content();
                        $title = get_the_title();
                        $date = get_the_date('d.m.Y H:i');
                        $author = get_the_author();
                        
                        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ—Å—Ç –≤ —Ç–æ–º –∂–µ –ø–æ—Ä—è–¥–∫–µ, –∫–∞–∫ –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ WordPress
                        ?>
                        <div class="wp-post">
                            <div class="wp-post-header">
                                <h3 class="wp-post-title"><?php echo esc_html($title); ?></h3>
                                <div class="wp-post-date"><?php echo $date; ?></div>
                            </div>
                            
                            <div class="wp-post-content">
                                <?php 
                                // –í—ã–≤–æ–¥–∏–º –∫–æ–Ω—Ç–µ–Ω—Ç –∫–∞–∫ –µ—Å—Ç—å, —Å–æ—Ö—Ä–∞–Ω—è—è –≤—Å–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
                                the_content();
                                
                                // –ï—Å–ª–∏ –µ—Å—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –≥–∞–ª–µ—Ä–µ–µ, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∏—Ö
                                if (get_post_gallery()) {
                                    echo '<div class="wp-post-gallery">';
                                    echo get_post_gallery();
                                    echo '</div>';
                                }
                                ?>
                            </div>
                            
                            <?php if (current_user_can('edit_posts')): ?>
                                <div style="margin-top: 15px; text-align: right;">
                                    <a href="<?php echo get_edit_post_link(); ?>" target="_blank" 
                                       style="background: #667eea; color: white; padding: 8px 15px; 
                                              border-radius: 5px; text-decoration: none; font-size: 14px;">
                                        ‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å 
                                    </a>
                                </div>
                            <?php endif; ?>
                        </div>
                        <?php
                    endwhile;
                    wp_reset_postdata();
                else :
                    ?>
                    <div class="no-posts">
                        <p>–ü–æ–∫–∞ –Ω–µ—Ç –Ω–æ–≤–æ—Å—Ç–µ–π –≤ WordPress. –ó–∞–π–¥–∏—Ç–µ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å WordPress –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ—Å—Ç–æ–≤.</p>
                        <?php if (current_user_can('edit_posts')): ?>
                            <div style="margin-top: 15px; text-align: center;">
                                <a href="<?php echo admin_url('post-new.php'); ?>" target="_blank" 
                                   style="background: #4caf50; color: white; padding: 12px 24px; 
                                          border-radius: 8px; text-decoration: none; display: inline-block; font-weight: bold;">
                                    üìù –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø–æ—Å—Ç 
                                </a>
                            </div>
                            <div style="margin-top: 15px; font-size: 14px; color: #666; text-align: center;">
                                <strong>–°–æ–≤–µ—Ç:</strong> –î–æ–±–∞–≤–ª—è–π—Ç–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ (H1, H2, H3), –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, —Å–ø–∏—Å–∫–∏ –∏ –∞–±–∑–∞—Ü—ã –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ WordPress.<br>
                                –û–Ω–∏ –±—É–¥—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∑–¥–µ—Å—å —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤—Å–µ—Ö —Å—Ç–∏–ª–µ–π!
                            </div>
                        <?php endif; ?>
                    </div>
                <?php endif; ?>
                
                <?php if ($query->have_posts() && current_user_can('edit_posts')): ?>
                    <div style="text-align: center; margin-top: 30px; padding: 20px; background: rgba(255, 248, 225, 0.5); border-radius: 10px;">
                        <h4 style="color: #ff9800; margin-bottom: 10px;">üì¢ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –ø–æ—Å—Ç–æ–≤</h4>
                        <p style="margin-bottom: 10px;">
                            <strong>–ß—Ç–æ–±—ã –æ–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –Ω–æ–≤–æ—Å—Ç—å:</strong><br>
                            1. –ó–∞–π–¥–∏—Ç–µ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å WordPress<br>
                            2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø–æ—Å—Ç —á–µ—Ä–µ–∑ "–ó–∞–ø–∏—Å–∏" ‚Üí "–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é"<br>
                            3. –ù–∞–ø–∏—à–∏—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∏ —Ç–µ–∫—Å—Ç –Ω–æ–≤–æ—Å—Ç–∏<br>
                            4. –î–æ–±–∞–≤—å—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É "–î–æ–±–∞–≤–∏—Ç—å –º–µ–¥–∏–∞—Ñ–∞–π–ª"<br>
                            5. –ù–∞–∂–º–∏—Ç–µ "–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å"<br>
                        </p>
                        <p style="font-size: 13px; color: #5d4037;">
                            <strong>–í–∞–∂–Ω–æ:</strong> –í—Å–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (–∑–∞–≥–æ–ª–æ–≤–∫–∏, —Å–ø–∏—Å–∫–∏, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è) –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ –Ω–∞ —Å–∞–π—Ç–µ!
                        </p>
                    </div>
                <?php endif; ?>
            </div>
        </div>

        <!-- –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å -->
        <div id="adminPanel" class="admin-panel">
            <div class="admin-header">
                <button class="logout-btn" onclick="logout()">–í—ã–π—Ç–∏</button>
                <h2>–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å</h2>
                <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º —Å–∞–π—Ç–∞ "–¢—Ä—É–¥–æ–≤—ã–µ –æ—Ç—Ä—è–¥—ã –û—Ä–µ–Ω–±—É—Ä–≥–∞"</p>
                <button class="save-all-btn" onclick="saveAllChanges()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
            </div>

            <div class="admin-nav">
                <button class="nav-btn active" onclick="showAdminSection('posts')">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Å—Ç–∞–º–∏</button>
                <button class="nav-btn" onclick="showAdminSection('users')">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</button>
                <button class="nav-btn" onclick="showAdminSection('stats')">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>
                <button class="nav-btn" onclick="showAdminSection('security')">–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</button>
                <button class="nav-btn" onclick="showAdminSection('points')">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–ª–ª–∞–º–∏</button>
            </div>

            <!-- –°–µ–∫—Ü–∏—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ—Å—Ç–∞–º–∏ -->
            <div id="adminPostsSection" class="admin-section active">
                <div class="lavender-section">
                    <h3>üåø –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞—à–∏–º–∏ –ø–æ—Å—Ç–∞–º–∏</h3>
                    <p>–°–æ–∑–¥–∞–≤–∞–π—Ç–µ –∏ —É–ø—Ä–∞–≤–ª—è–π—Ç–µ –Ω–æ–≤–æ—Å—Ç—è–º–∏ –∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è–º–∏ –¥–ª—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –ø—Ä–æ–≥—Ä–∞–º–º—ã.</p>
                    <button class="save-btn" onclick="savePosts()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ø–æ—Å—Ç–∞—Ö</button>
                </div>

                <!-- –§–æ—Ä–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ—Å—Ç–∞ -->
                <div class="post-form">
                    <h3 class="form-title">–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø–æ—Å—Ç</h3>
                    <form id="createPostForm">
                        <div class="form-group">
                            <input type="text" id="postTitle" placeholder="–ó–∞–≥–æ–ª–æ–≤–æ–∫ –ø–æ—Å—Ç–∞" required>
                        </div>
                        <div class="form-group">
                            <textarea id="postContent" placeholder="–¢–µ–∫—Å—Ç –ø–æ—Å—Ç–∞ (–∫–∞–∂–¥—ã–π –∞–±–∑–∞—Ü –±—É–¥–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–º –±–ª–æ–∫–æ–º)" rows="10" required></textarea>
                        </div>
                        <div class="form-group">
                            <label>–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–º–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ):</label>
                            <input type="file" id="postImage" accept="image/*" multiple>
                            <div id="multipleImagePreview" style="margin-top: 10px;"></div>
                        </div>
                        <button type="button" class="submit-btn" onclick="createPost()">üì¢ –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –ø–æ—Å—Ç</button>
                    </form>
                </div>

                <!-- –°–ø–∏—Å–æ–∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ—Å—Ç–æ–≤ -->
                <div class="posts-list">
                    <h3>–°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ—Å—Ç—ã</h3>
                    <div id="adminPostsList">
                        <!-- –°–ø–∏—Å–æ–∫ –ø–æ—Å—Ç–æ–≤ –¥–ª—è –∞–¥–º–∏–Ω–∞ -->
                    </div>
                </div>
            </div>

            <!-- –°–µ–∫—Ü–∏—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ -->
            <div id="adminUsersSection" class="admin-section">
                <div class="lavender-section">
                    <h3>üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</h3>
                    <p>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ —É—á–µ—Ç–Ω—ã–º–∏ –∑–∞–ø–∏—Å—è–º–∏.</p>
                    <button class="save-btn" onclick="saveUsers()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö</button>
                </div>

                <div class="content-section">
                    <h3>–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h3>
                    <form id="registerUserForm">
                        <div class="form-group">
                            <input type="text" id="newUserName" placeholder="–§–ò–û –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" required>
                        </div>
                        <div class="form-group">
                            <input type="email" id="newUserEmail" placeholder="Email" required>
                        </div>
                        <div class="form-group">
                            <input type="text" id="newUserLogin" placeholder="–õ–æ–≥–∏–Ω" required>
                        </div>
                        <div class="form-group">
                            <input type="password" id="newUserPassword" placeholder="–ü–∞—Ä–æ–ª—å" required>
                        </div>
                        <div class="form-group">
                            <select id="newUserRole" required>
                                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ä–æ–ª—å</option>
                                <option value="participant">–£—á–∞—Å—Ç–Ω–∏–∫</option>
                                <option value="comstaff">–ö–æ–º—Å–æ—Å—Ç–∞–≤</option>
                                <option value="moderator">–ú–æ–¥–µ—Ä–∞—Ç–æ—Ä</option>
                                <option value="admin">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</option>
                            </select>
                        </div>
                        <button type="button" class="submit-btn" onclick="registerUser()">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å</button>
                    </form>
                </div>

                <div class="users-list">
                    <h3>–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h3>
                    <div id="usersList">
                        <!-- –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π -->
                    </div>
                </div>
            </div>

            <!-- –°–µ–∫—Ü–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ -->
            <div id="adminStatsSection" class="admin-section">
                <div class="lavender-section">
                    <h3>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
                    <p>–û–±–∑–æ—Ä –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã.</p>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="totalUsers">0</div>
                        <div>–í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="totalPosts">0</div>
                        <div>–í—Å–µ–≥–æ –ø–æ—Å—Ç–æ–≤</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="totalPoints">0</div>
                        <div>–í—Å–µ–≥–æ –±–∞–ª–ª–æ–≤</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="activeToday">0</div>
                        <div>–ê–∫—Ç–∏–≤–Ω—ã—Ö —Å–µ–≥–æ–¥–Ω—è</div>
                    </div>
                </div>
            </div>

            <!-- –°–µ–∫—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ -->
            <div id="adminSecuritySection" class="admin-section">
                <div class="lavender-section">
                    <h3>üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</h3>
                    <p>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–æ–º.</p>
                </div>

                <div class="content-section">
                    <h3>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</h3>
                    <div class="form-group">
                        <label>–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –ø–∞—Ä–æ–ª—è:</label>
                        <input type="number" value="8" min="6" max="20">
                    </div>
                    <div class="form-group">
                        <label>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã—Ö–æ–¥ —á–µ—Ä–µ–∑ (–º–∏–Ω—É—Ç):</label>
                        <input type="number" value="30" min="5" max="120">
                    </div>
                    <button class="save-btn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</button>
                </div>
            </div>

            <!-- –°–µ–∫—Ü–∏—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–ª–ª–∞–º–∏ -->
            <div id="adminPointsSection" class="admin-section">
                <div class="lavender-section">
                    <h3>üèÜ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–ª–ª–∞–º–∏</h3>
                    <p>–ù–∞—á–∏—Å–ª–µ–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ –±–∞–ª–ª–æ–≤ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º –∑–∞ –¥–æ–±—Ä—ã–µ –¥–µ–ª–∞.</p>
                    <button class="save-btn" onclick="savePoints()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –±–∞–ª–ª–∞—Ö</button>
                </div>

                <div class="content-section">
                    <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–ª–ª–∞–º–∏ —É—á–∞—Å—Ç–Ω–∏–∫–∞</h3>
                    <div class="points-form">
                        <div class="form-group">
                            <select id="pointsUserSelect">
                                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–ª–ª–æ–≤:</label>
                            <input type="number" id="pointsAmount" class="points-input" min="1" max="100" value="10">
                        </div>
                        <div class="form-group">
                            <label>–ü—Ä–∏—á–∏–Ω–∞:</label>
                            <input type="text" id="pointsReason" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è">
                        </div>
                        <div class="points-buttons">
                            <button class="add-points-btn" onclick="addPoints()">–ù–∞—á–∏—Å–ª–∏—Ç—å –±–∞–ª–ª—ã</button>
                            <button class="remove-points-btn" onclick="removePoints()">–£–¥–∞–ª–∏—Ç—å –±–∞–ª–ª—ã</button>
                        </div>
                    </div>
                </div>

                <div class="content-section">
                    <h3>–ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π —Å –±–∞–ª–ª–∞–º–∏</h3>
                    <div id="pointsHistory">
                        <!-- –ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π —Å –±–∞–ª–ª–∞–º–∏ -->
                    </div>
                </div>
            </div>
        </div>

        <!-- –ü–∞–Ω–µ–ª—å –∫–æ–º—Å–æ—Å—Ç–∞–≤–∞ -->
        <div id="comstaffPanel" class="comstaff-panel">
            <div class="comstaff-header">
                <button class="logout-btn" onclick="logout()">–í—ã–π—Ç–∏</button>
                <h2>–ü–∞–Ω–µ–ª—å –∫–æ–º—Å–æ—Å—Ç–∞–≤–∞</h2>
                <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ç—Ä—è–¥–æ–º "–õ–∞–≤–∞–Ω–¥–∞"</p>
                <div class="bot-info">
                    <strong>üì¢ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –ø–æ—Å—Ç–æ–≤:</strong><br>
                    ‚ú® –ß—Ç–æ–±—ã –≤—ã–ª–æ–∂–∏—Ç—å –ø–æ—Å—Ç, –Ω–∞–ø–∏—à–∏—Ç–µ –≤ Telegram –±–æ—Ç–∞ –≤ 21:00 –∫–∞–∂–¥—ã–π –¥–µ–Ω—å.<br>
                    ‚ú® –ü–æ—Å—Ç –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–∫–ª–∞–¥—ã–≤–∞—Ç—å—Å—è, –µ—Å–ª–∏ –≤—ã –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ –µ–º—É —Ñ–æ—Ç–æ –∏ —Ç–µ–∫—Å—Ç.<br>
                    ‚ú® –°—Å—ã–ª–∫–∞ –Ω–∞ –±–æ—Ç–∞: <a href="https://t.me/x3_x3_x3bot" class="tg-bot-link" target="_blank">@x3_x3_x3bot</a><br>
                    ‚ú® <strong>–°–æ–≤–µ—Ç:</strong> –î–ª—è –ª—É—á—à–µ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–æ–±–∞–≤–ª—è–π—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ WordPress –∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –∞–±–∑–∞—Ü—ã!
                </div>
                <div class="user-nav">
                    <button class="nav-user-btn active" onclick="showComstaffSection('stats')">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>
                    <button class="nav-user-btn" onclick="showComstaffSection('members')">üë• –£—á–∞—Å—Ç–Ω–∏–∫–∏</button>
                    <button class="nav-user-btn" onclick="showComstaffSection('points')">üèÜ –ë–∞–ª–ª—ã</button>
                    <button class="nav-user-btn" onclick="showComstaffSection('tasks')">üìã –ó–∞–¥–∞—á–∏</button>
                </div>
            </div>

            <!-- –°–µ–∫—Ü–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ -->
            <div id="comstaffStatsSection" class="comstaff-section active">
                <div class="welcome-comstaff">
                    –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –ø–∞–Ω–µ–ª—å –∫–æ–º—Å–æ—Å—Ç–∞–≤–∞, <span id="comstaffUserName"></span>!
                </div>

                <div class="comstaff-stats-grid">
                    <div class="comstaff-stat-card">
                        <div class="comstaff-stat-number" id="comstaffTotalMembers">0</div>
                        <div>–í—Å–µ–≥–æ –±–æ–π—Ü–æ–≤</div>
                    </div>
                    <div class="comstaff-stat-card">
                        <div class="comstaff-stat-number" id="comstaffActiveMembers">0</div>
                        <div>–ê–∫—Ç–∏–≤–Ω—ã—Ö —Å–µ–≥–æ–¥–Ω—è</div>
                    </div>
                    <div class="comstaff-stat-card">
                        <div class="comstaff-stat-number" id="comstaffTotalPoints">0</div>
                        <div>–í—Å–µ–≥–æ –±–∞–ª–ª–æ–≤</div>
                    </div>
                    <div class="comstaff-stat-card">
                        <div class="comstaff-stat-number" id="comstaffAvgPoints">0</div>
                        <div>–°—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª</div>
                    </div>
                </div>

                <div class="quick-actions">
                    <button class="quick-action-btn" onclick="showComstaffSection('members')">
                        üë• –°–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
                    </button>
                    <button class="quick-action-btn" onclick="showComstaffSection('points')">
                        üèÜ –ù–∞—á–∏—Å–ª–∏—Ç—å –±–∞–ª–ª—ã
                    </button>
                    <button class="quick-action-btn" onclick="createQuickTask()">
                        üìã –°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É
                    </button>
                    <button class="quick-action-btn" onclick="showWordpressEditor()">
                        üìù –°–æ–∑–¥–∞—Ç—å –ø–æ—Å—Ç –≤ WordPress
                    </button>
                </div>

                <div class="content-section">
                    <h3>–õ—É—á—à–∏–µ –±–æ–π—Ü—ã</h3>
                    <div id="topMembersList">
                        <!-- –¢–æ–ø –±–æ–π—Ü—ã -->
                    </div>
                </div>
            </div>

            <!-- –°–µ–∫—Ü–∏—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–æ–π—Ü–∞–º–∏ -->
            <div id="comstaffMembersSection" class="comstaff-section">
                <div class="lavender-section">
                    <h3>üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–æ–π—Ü–∞–º–∏</h3>
                    <p>–ü—Ä–æ—Å–º–æ—Ç—Ä –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏ –æ—Ç—Ä—è–¥–∞ "–õ–∞–≤–∞–Ω–¥–∞"</p>
                </div>

                <div class="content-section">
                    <h3>–ü–æ–∏—Å–∫ –±–æ–π—Ü–∞</h3>
                    <div class="form-group">
                        <input type="text" id="memberSearch" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è –∏–ª–∏ –ª–æ–≥–∏–Ω –±–æ–π—Ü–∞" 
                               onkeyup="searchMembers()">
                    </div>
                </div>

                <div class="members-list">
                    <h3>–°–ø–∏—Å–æ–∫ –±–æ–π—Ü–æ–≤</h3>
                    <div id="comstaffMembersList">
                        <!-- –°–ø–∏—Å–æ–∫ –±–æ–π—Ü–æ–≤ -->
                    </div>
                </div>
            </div>

            <!-- –°–µ–∫—Ü–∏—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–ª–ª–∞–º–∏ -->
            <div id="comstaffPointsSection" class="comstaff-section">
                <div class="lavender-section">
                    <h3>üèÜ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–ª–ª–∞–º–∏</h3>
                    <p>–ù–∞—á–∏—Å–ª–µ–Ω–∏–µ –±–∞–ª–ª–æ–≤ –±–æ–π—Ü–∞–º –∑–∞ –¥–æ–±—Ä—ã–µ –¥–µ–ª–∞ –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è</p>
                </div>

                <div class="comstaff-points-form">
                    <h3>–ë—ã—Å—Ç—Ä–æ–µ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ –±–∞–ª–ª–æ–≤</h3>
                    <div class="form-group">
                        <select id="comstaffPointsUserSelect">
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –±–æ–π—Ü–∞</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–ª–ª–æ–≤:</label>
                        <input type="number" id="comstaffPointsAmount" class="points-input" min="1" max="50" value="10">
                    </div>
                    <div class="form-group">
                        <label>–ü—Ä–∏—á–∏–Ω–∞:</label>
                        <select id="comstaffPointsReason">
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∏—á–∏–Ω—É</option>
                            <option value="–£—á–∞—Å—Ç–∏–µ –≤ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–∏">–£—á–∞—Å—Ç–∏–µ –≤ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–∏</option>
                            <option value="–ü–æ–º–æ—â—å –æ—Ç—Ä—è–¥—É">–ü–æ–º–æ—â—å –æ—Ç—Ä—è–¥—É</option>
                            <option value="–ê–∫—Ç–∏–≤–Ω–∞—è —Ä–∞–±–æ—Ç–∞">–ê–∫—Ç–∏–≤–Ω–∞—è —Ä–∞–±–æ—Ç–∞</option>
                            <option value="–õ–∏–¥–µ—Ä—Å–∫–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞">–õ–∏–¥–µ—Ä—Å–∫–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞</option>
                            <option value="–¢–≤–æ—Ä—á–µ—Å–∫–∏–π –≤–∫–ª–∞–¥">–¢–≤–æ—Ä—á–µ—Å–∫–∏–π –≤–∫–ª–∞–¥</option>
                            <option value="–î—Ä—É–≥–æ–µ">–î—Ä—É–≥–æ–µ</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ):</label>
                        <input type="text" id="comstaffPointsComment" placeholder="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è">
                    </div>
                    <div class="points-buttons">
                        <button class="add-points-btn" onclick="comstaffAddPoints()">–ù–∞—á–∏—Å–ª–∏—Ç—å –±–∞–ª–ª—ã</button>
                        <button class="remove-points-btn" onclick="comstaffRemovePoints()">–°–ø–∏—Å–∞—Ç—å –±–∞–ª–ª—ã</button>
                    </div>
                </div>

                <div class="content-section">
                    <h3>–ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –±–∞–ª–ª–∞–º–∏</h3>
                    <div id="comstaffPointsHistory">
                        <!-- –ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π -->
                    </div>
                </div>
            </div>

            <!-- –°–µ–∫—Ü–∏—è –∑–∞–¥–∞—á -->
            <div id="comstaffTasksSection" class="comstaff-section">
                <div class="lavender-section">
                    <h3>üìã –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∞–º–∏</h3>
                    <p>–°–æ–∑–¥–∞–Ω–∏–µ –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á –¥–ª—è –±–æ–π—Ü–æ–≤ –æ—Ç—Ä—è–¥–∞</p>
                </div>

                <div class="content-section">
                    <h3>–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∑–∞–¥–∞—á—É</h3>
                    <form id="createTaskForm">
                        <div class="form-group">
                            <input type="text" id="taskTitle" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏" required>
                        </div>
                        <div class="form-group">
                            <textarea id="taskDescription" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏" rows="4" required></textarea>
                        </div>
                        <div class="form-group">
                            <label>–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å:</label>
                            <select id="taskAssignee">
                                <option value="all">–í—Å–µ –±–æ–π—Ü—ã</option>
                                <!-- –û–ø—Ü–∏–∏ –±–æ–π—Ü–æ–≤ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JS -->
                            </select>
                        </div>
                        <div class="form-group">
                            <label>–°—Ä–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:</label>
                            <input type="date" id="taskDeadline" required>
                        </div>
                        <div class="form-group">
                            <label>–ë–∞–ª–ª—ã –∑–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ:</label>
                            <input type="number" id="taskPoints" min="1" max="100" value="10">
                        </div>
                        <button type="button" class="submit-btn" onclick="createTask()">–°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É</button>
                    </form>
                </div>

                <div class="task-list">
                    <h3>–ê–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏</h3>
                    <div id="activeTasksList">
                        <!-- –ê–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏ -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—Ö–æ–¥–∞ –¥–ª—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ -->
    <div id="loginModal" class="modal">
        <div class="auth-form">
            <button class="close-btn" onclick="closeLoginModal()">‚úï</button>
            <h2>–í—Ö–æ–¥ –¥–ª—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</h2>
            <form id="loginForm">
                <div class="form-group">
                    <input type="text" id="loginUsername" placeholder="–õ–æ–≥–∏–Ω" required>
                </div>
                <div class="form-group">
                    <input type="password" id="loginPassword" placeholder="–ü–∞—Ä–æ–ª—å" required>
                </div>
                <button type="button" class="submit-btn" onclick="login()">–í–æ–π—Ç–∏</button>
            </form>
            <div class="error-message" id="loginError" style="display: none;"></div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—Ö–æ–¥–∞ –¥–ª—è –∫–æ–º—Å–æ—Å—Ç–∞–≤–∞ -->
    <div id="comstaffLoginModal" class="modal">
        <div class="auth-form">
            <button class="close-btn" onclick="closeComstaffLoginModal()">‚úï</button>
            <h2>–í—Ö–æ–¥ –¥–ª—è –∫–æ–º—Å–æ—Å—Ç–∞–≤–∞</h2>
            <form id="comstaffLoginForm">
                <div class="form-group">
                    <input type="text" id="comstaffLoginUsername" placeholder="–õ–æ–≥–∏–Ω –∫–æ–º—Å–æ—Å—Ç–∞–≤–∞" required>
                </div>
                <div class="form-group">
                    <input type="password" id="comstaffLoginPassword" placeholder="–ü–∞—Ä–æ–ª—å" required>
                </div>
                <button type="button" class="submit-btn" onclick="comstaffLogin()">–í–æ–π—Ç–∏</button>
            </form>
            <div class="error-message" id="comstaffLoginError" style="display: none;"></div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∫–∞–ª–µ–Ω–¥–∞—Ä—è –¥–ª—è –∫–æ–º—Å–æ—Å—Ç–∞–≤–∞ -->
    <div id="comstaffCalendarModal" class="calendar-modal">
        <div class="calendar-container">
            <div class="calendar-header">
                <div class="calendar-title">–ö–∞–ª–µ–Ω–¥–∞—Ä—å –∫–æ–º—Å–æ—Å—Ç–∞–≤–∞</div>
                <button class="close-btn" onclick="closeComstaffCalendar()">‚úï</button>
            </div>
            
            <div class="calendar-nav">
                <button class="calendar-nav-btn" onclick="changeMonth(-1)">‚Üê –ü—Ä–µ–¥</button>
                <div class="calendar-current-month" id="currentMonthYear"></div>
                <button class="calendar-nav-btn" onclick="changeMonth(1)">–°–ª–µ–¥ ‚Üí</button>
            </div>
            
            <div class="calendar-grid" id="calendarDays">
                <!-- –î–Ω–∏ –∫–∞–ª–µ–Ω–¥–∞—Ä—è –±—É–¥—É—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã JavaScript -->
            </div>
            
            <div class="calendar-actions">
                <button class="calendar-cancel-btn" onclick="closeComstaffCalendar()">–û—Ç–º–µ–Ω–∞</button>
                <button class="calendar-confirm-btn" onclick="confirmCalendarSelection()">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—Ö–æ–¥–∞ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ -->
    <div id="adminLoginModal" class="modal">
        <div class="auth-form">
            <button class="close-btn" onclick="closeAdminLoginModal()">‚úï</button>
            <h2>–í—Ö–æ–¥ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h2>
            <form id="adminLoginForm">
                <div class="form-group">
                    <input type="text" id="adminLoginUsername" placeholder="–õ–æ–≥–∏–Ω –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞" required>
                </div>
                <div class="form-group">
                    <input type="password" id="adminLoginPassword" placeholder="–ü–∞—Ä–æ–ª—å" required>
                </div>
                <button type="button" class="submit-btn" onclick="adminLogin()">–í–æ–π—Ç–∏</button>
            </form>
            <div class="error-message" id="adminLoginError" style="display: none;"></div>
        </div>
    </div>

    <!-- WordPress Footer (–µ—Å–ª–∏ –µ—Å—Ç—å) -->
    <?php get_footer(); ?>

<script>
// ========== –û–°–ù–û–í–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï –ò –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø ==========

// –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
let currentUser = null;
let syncState = {
    isSyncing: false,
    pendingChanges: false,
    retryCount: 0,
    currentDeviceId: generateDeviceId(),
    online: navigator.onLine
};

// –ö–∞–ª–µ–Ω–¥–∞—Ä–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
let currentCalendarDate = new Date();
let selectedCalendarDate = null;

// –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
const SYNC_CONFIG = {
    storageKey: 'teenWorkTeamsSync',
    checkInterval: 5000,
    cacheTTL: 24 * 60 * 60 * 1000,
    maxRetries: 3
};

// –î–∞–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã
let syncData = {
    version: 1,
    dataHash: '',
    lastModified: Date.now(),
    lastSynced: null,
    users: [],
    ourPosts: [],
    tasks: [],
    pointsHistory: [],
    totalDeeds: 243
};

// –ü—Ä–∏–º–µ—Ä –Ω–∞—á–∞–ª—å–Ω—ã—Ö –ø–æ—Å—Ç–æ–≤
const INITIAL_POSTS = [
    {
        id: 1,
        title: "–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –æ—Ç –∫–æ–º–∞–Ω–¥–∏—Ä–∞ –æ—Ç—Ä—è–¥–∞",
        content: "–î–æ—Ä–æ–≥–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏! –†–∞–¥–∞ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –≤–∞—Å –≤ –Ω–æ–≤–æ–º —Å–µ–∑–æ–Ω–µ —Ç—Ä—É–¥–æ–≤–æ–≥–æ –æ—Ç—Ä—è–¥–∞ –ø–æ–¥—Ä–æ—Å—Ç–∫–æ–≤ '–õ–∞–≤–∞–Ω–¥–∞'. –í–ø–µ—Ä–µ–¥–∏ –Ω–∞—Å –∂–¥–µ—Ç –º–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã—Ö –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π, –ø–æ–ª–µ–∑–Ω—ã—Ö –¥–µ–ª –∏ –Ω–µ–∑–∞–±—ã–≤–∞–µ–º—ã—Ö –º–æ–º–µ–Ω—Ç–æ–≤. –î–∞–≤–∞–π—Ç–µ —Å–¥–µ–ª–∞–µ–º —ç—Ç–æ—Ç —Å–µ–∑–æ–Ω —Å–∞–º—ã–º –ª—É—á—à–∏–º!",
        date: "2024-01-05",
        image: "",
        created: Date.now(),
        createdBy: "–ö–æ–º–∞–Ω–¥–∏—Ä –æ—Ç—Ä—è–¥–∞"
    },
    {
        id: 2,
        title: "–ü–µ—Ä–≤—ã–π —Å—É–±–±–æ—Ç–Ω–∏–∫ —Å–µ–∑–æ–Ω–∞",
        content: "–£–∂–µ –≤ —ç—Ç—É —Å—É–±–±–æ—Ç—É —Å–æ—Å—Ç–æ–∏—Ç—Å—è –Ω–∞—à –ø–µ—Ä–≤—ã–π —Å—É–±–±–æ—Ç–Ω–∏–∫! –°–æ–±–∏—Ä–∞–µ–º—Å—è —É —à–∫–æ–ª—ã ‚Ññ25 –≤ 10:00. –ü—Ä–∏–Ω–æ—Å–∏—Ç–µ —Å —Å–æ–±–æ–π —Ö–æ—Ä–æ—à–µ–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ –∏ –ø–µ—Ä—á–∞—Ç–∫–∏. –ü–æ—Å–ª–µ —Ä–∞–±–æ—Ç—ã –≤—Å–µ—Ö –∂–¥–µ—Ç –≥–æ—Ä—è—á–∏–π —á–∞–π –∏ —Å–ª–∞–¥–∫–∏–π —Å—Ç–æ–ª.",
        date: "2024-01-06",
        image: "",
        created: Date.now(),
        createdBy: "–ö–æ–º–∞–Ω–¥–∏—Ä –æ—Ç—Ä—è–¥–∞"
    },
    {
        id: 3,
        title: "–ù–∞–±–æ—Ä –Ω–æ–≤—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤",
        content: "–û–±—ä—è–≤–ª—è–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä –≤ –Ω–∞—à –æ—Ç—Ä—è–¥. –ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –¥—Ä—É–∑—å—è, –∫–æ—Ç–æ—Ä—ã–µ —Ö–æ—Ç—è—Ç —Å—Ç–∞—Ç—å —á–∞—Å—Ç—å—é –Ω–∞—à–µ–π –∫–æ–º–∞–Ω–¥—ã, –ø—Ä–∏–≤–æ–¥–∏—Ç–µ –∏—Ö –Ω–∞ —Å–æ–±—Ä–∞–Ω–∏–µ –≤ –ø—è—Ç–Ω–∏—Ü—É. –í–æ–∑—Ä–∞—Å—Ç: 14-18 –ª–µ—Ç.",
        date: "2024-01-07",
        image: "",
        created: Date.now(),
        createdBy: "–ö–æ–º–∞–Ω–¥–∏—Ä –æ—Ç—Ä—è–¥–∞"
    }
];

// ========== –û–°–ù–û–í–ù–´–ï –§–£–ù–ö–¶–ò–ò –°–ò–°–¢–ï–ú–´ ==========

// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è ID —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
function generateDeviceId() {
    let deviceId = localStorage.getItem('deviceId');
    if (!deviceId) {
        deviceId = 'device_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
        localStorage.setItem('deviceId', deviceId);
    }
    return deviceId;
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
function initializeData() {
    // –ü—ã—Ç–∞–µ–º—Å—è –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ localStorage
    const loaded = loadFromLocalStorage();
    
    // –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
    if (!loaded) {
        syncData.users = [
            // –ë–æ–π—Ü—ã
            { id: 1, name: "–£—Å–º–∞–Ω–æ–≤ –ú–∞—Ç–≤–µ–π", email: "–Ω–µ –∏–∑–≤–µ—Å—Ç–Ω–æ", login: "usmanov", password: "usmanov", role: "participant", points: 0, age: '–Ω–µ –∏–∑–≤–µ—Å—Ç–Ω–æ', registered: "2023-05-15", lastActive: "–°–µ–π—á–∞—Å", events: 5 },
            { id: 2, name: "–ë–µ–ª–∏–∫–æ–≤–∞ –ö–∞—Ç—è", email: "–Ω–µ –∏–∑–≤–µ—Å—Ç–Ω–æ", login: "belikova", password: "belikova", role: "participant", points: 0, age: '–Ω–µ –∏–∑–≤–µ—Å—Ç–Ω–æ', registered: "2023-04-20", lastActive: "2 —á–∞—Å–∞ –Ω–∞–∑–∞–¥", events: 8 },
            { id: 3, name: "–ì–æ—Ä–± –°–æ—Ñ—å—è", email: "–Ω–µ –∏–∑–≤–µ—Å—Ç–Ω–æ", login: "gorb", password: "gorb", role: "participant", points: 0, age: '–Ω–µ –∏–∑–≤–µ—Å—Ç–Ω–æ', registered: "2023-03-10", lastActive: "–í—á–µ—Ä–∞", events: 12 },
            { id: 4, name: "–ë—É—Ö–∞—Ä–µ–≤–∞ –õ–∏–∑–∞", email: "–Ω–µ –∏–∑–≤–µ—Å—Ç–Ω–æ", login: "buhareva", password: "buhareva", role: "participant", points: 0, age: '–Ω–µ –∏–∑–≤–µ—Å—Ç–Ω–æ', registered: "2023-06-01", lastActive: "–°–µ–π—á–∞—Å", events: 7 },
            { id: 5, name: "–ú–æ–∑–æ–ª–µ–≤—Å–∫–∞—è –°–æ—Ñ–∏—è", email: "–Ω–µ –∏–∑–≤–µ—Å—Ç–Ω–æ", login: "mozolevskaya", password: "mozolevskaya", role: "participant", points: 0, age: '–Ω–µ –∏–∑–≤–µ—Å—Ç–Ω–æ', registered: "2023-05-20", lastActive: "3 —á–∞—Å–∞ –Ω–∞–∑–∞–¥", events: 9 },
            { id: 6, name: "–ë—É—Ä–ª—è–≥–∏–Ω –ú–∏—à–∞", email: "–Ω–µ –∏–∑–≤–µ—Å—Ç–Ω–æ", login: "burlyagin", password: "burlyagin", role: "participant", points: 0, age: '–Ω–µ –∏–∑–≤–µ—Å—Ç–Ω–æ', registered: "2023-04-15", lastActive: "–í—á–µ—Ä–∞", events: 6 },
            { id: 7, name: "–ö—É–≤—à–∏–Ω–æ–≤–∞ –õ–∏–∑–∞", email: "–Ω–µ –∏–∑–≤–µ—Å—Ç–Ω–æ", login: "kuvshinova", password: "kuvshinova", role: "participant", points: 0, age: '–Ω–µ –∏–∑–≤–µ—Å—Ç–Ω–æ', registered: "2023-05-10", lastActive: "–°–µ–π—á–∞—Å", events: 8 },
            { id: 8, name: "–®–∏–Ω–¥–∏–Ω–∞ –¢–∞–Ω—è", email: "–Ω–µ –∏–∑–≤–µ—Å—Ç–Ω–æ", login: "shindina", password: "shindina", role: "participant", points: 0, age: '–Ω–µ –∏–∑–≤–µ—Å—Ç–Ω–æ', registered: "2023-06-05", lastActive: "2 –¥–Ω—è –Ω–∞–∑–∞–¥", events: 7 },
            { id: 9, name: "–ò—Å–∫–∏–Ω–¥–∏—Ä–æ–≤–∞ –°–∞–±–∏–Ω–∞", email: "–Ω–µ –∏–∑–≤–µ—Å—Ç–Ω–æ", login: "iskindirova", password: "iskindirova", role: "participant", points: 0, age: '–Ω–µ –∏–∑–≤–µ—Å—Ç–Ω–æ', registered: "2023-03-25", lastActive: "–°–µ–π—á–∞—Å", events: 10 },
            { id: 10, name: "–£—Å—Ç–∏–Ω–æ–≤–∞ –†–æ–∫—Å–∞–Ω–∞", email: "–Ω–µ –∏–∑–≤–µ—Å—Ç–Ω–æ", login: "ustinova", password: "ustinova", role: "participant", points: 0, age: '–Ω–µ –∏–∑–≤–µ—Å—Ç–Ω–æ', registered: "2023-04-30", lastActive: "–í—á–µ—Ä–∞", events: 6 },
            { id: 11, name: "–ñ–∞–ø–ø–∞—Ä–æ–≤ –¢–∏–º—É—Ä", email: "–Ω–µ –∏–∑–≤–µ—Å—Ç–Ω–æ", login: "zhapparov", password: "zhapparov", role: "participant", points: 0, age: '–Ω–µ –∏–∑–≤–µ—Å—Ç–Ω–æ', registered: "2023-05-08", lastActive: "–°–µ–π—á–∞—Å", events: 9 },
            { id: 12, name: "–ö–µ—á–∞–µ–≤–∞ –ê–Ω–Ω–∞", email: "–Ω–µ –∏–∑–≤–µ—Å—Ç–Ω–æ", login: "kechaeva", password: "kechaeva", role: "participant", points: 0, age: '–Ω–µ –∏–∑–≤–µ—Å—Ç–Ω–æ', registered: "2023-06-10", lastActive: "4 —á–∞—Å–∞ –Ω–∞–∑–∞–¥", events: 8 },
            { id: 13, name: "–®–∞—Ä–∞—Ñ—É—Ç–¥–∏–Ω–æ–≤–∞ –ê—Ä–∏–Ω–∞", email: "–Ω–µ –∏–∑–≤–µ—Å—Ç–Ω–æ", login: "sharafutdinova", password: "sharafutdinova", role: "participant", points: 0, age: '–Ω–µ –∏–∑–≤–µ—Å—Ç–Ω–æ', registered: "2023-05-25", lastActive: "–í—á–µ—Ä–∞", events: 7 },
            { id: 14, name: "–ì–æ—Ä—å–∫–æ–≤–∞ –ú–∞—Ä–∏—è", email: "–Ω–µ –∏–∑–≤–µ—Å—Ç–Ω–æ", login: "gorkova", password: "gorkova", role: "participant", points: 0, age: '–Ω–µ –∏–∑–≤–µ—Å—Ç–Ω–æ', registered: "2023-04-12", lastActive: "–°–µ–π—á–∞—Å", events: 9 },
            { id: 15, name: "–ò—à—É—Ç–∏–Ω–∞ –ö–∏—Ä–∞", email: "–Ω–µ –∏–∑–≤–µ—Å—Ç–Ω–æ", login: "ishutina", password: "ishutina", role: "participant", points: 0, age: '–Ω–µ –∏–∑–≤–µ—Å—Ç–Ω–æ', registered: "2023-05-18", lastActive: "2 —á–∞—Å–∞ –Ω–∞–∑–∞–¥", events: 7 },
            
            // –ö–∞–Ω–¥–∏–¥–∞—Ç—ã
            { id: 16, name: "–î–∞–≤—ã–¥–æ–≤–∞ –õ–µ–Ω–∞", email: "–Ω–µ –∏–∑–≤–µ—Å—Ç–Ω–æ", login: "davydova", password: "davydova", role: "participant", points: 0, age: '–Ω–µ –∏–∑–≤–µ—Å—Ç–Ω–æ', registered: "2023-06-15", lastActive: "–°–µ–π—á–∞—Å", events: 0 },
            { id: 17, name: "–°–∫—Ä–∏—Ü–∫–∞—è –í–∞—Ä—è", email: "–Ω–µ –∏–∑–≤–µ—Å—Ç–Ω–æ", login: "skritskaya", password: "skritskaya", role: "participant", points: 0, age: '–Ω–µ –∏–∑–≤–µ—Å—Ç–Ω–æ', registered: "2023-06-15", lastActive: "–°–µ–π—á–∞—Å", events: 0 },
            { id: 18, name: "–ê–∫–∏–º–æ–≤–∞ –í–∏–∫–∞", email: "–Ω–µ –∏–∑–≤–µ—Å—Ç–Ω–æ", login: "akimova", password: "akimova", role: "participant", points: 0, age: '–Ω–µ –∏–∑–≤–µ—Å—Ç–Ω–æ', registered: "2023-06-15", lastActive: "–°–µ–π—á–∞—Å", events: 0 },
            { id: 19, name: "–ú—É—Ä—Å–∞–ª–∏–º–æ–≤ –†–∞–∏–ª—å", email: "–Ω–µ –∏–∑–≤–µ—Å—Ç–Ω–æ", login: "mursalimov", password: "mursalimov", role: "participant", points: 0, age: '–Ω–µ –∏–∑–≤–µ—Å—Ç–Ω–æ', registered: "2023-06-15", lastActive: "–°–µ–π—á–∞—Å", events: 0 },
            { id: 20, name: "–ï—Ä–µ–º–µ–µ–≤–∞ –ê–Ω–∞—Å—Ç–∞—Å–∏—è", email: "–Ω–µ –∏–∑–≤–µ—Å—Ç–Ω–æ", login: "eremeeva", password: "eremeeva", role: "participant", points: 0, age: '–Ω–µ –∏–∑–≤–µ—Å—Ç–Ω–æ', registered: "2023-06-15", lastActive: "–°–µ–π—á–∞—Å", events: 0 },
            
            // –ö–æ–º—Å–æ—Å—Ç–∞–≤ (–∏–∑–º–µ–Ω–µ–Ω –ª–æ–≥–∏–Ω –∏ –ø–∞—Ä–æ–ª—å –∫–æ–º–∞–Ω–¥–∏—Ä–∞)
            { id: 100, name: "–ö–æ–º–∞–Ω–¥–∏—Ä –æ—Ç—Ä—è–¥–∞", email: "–∫–æ–º–∞–Ω–¥–∏—Ä@–ª–∞–≤–¥–∞.—Ä—É", login: "liza", password: "olp", role: "comstaff", points: 0, age: 17, registered: "2023-01-01", lastActive: "–°–µ–π—á–∞—Å", events: 25 },
            { id: 101, name: "–∫–∞–º–∏—Å–∞—Ä", email: "...", login: "kamis", password: "kam", role: "comstaff", points: 0, age: 0, registered: "//", lastActive: "//", events: 0 },
            { id: 102, name: "–º–µ—Ç–æ–¥–∏—Å—Ç", email: "...", login: "metod", password: "met", role: "comstaff", points: 0, age: 0, registered: "//", lastActive: "//", events: 0 },
            
            // –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã
            { id: 21, name: "–ì–ª–∞–≤–Ω—ã–π –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä", email: "admin@example.com", login: "lim", password: "limQ", role: "admin", points: 0, age: 0, registered: "2023-01-01", lastActive: "–°–µ–π—á–∞—Å", events: 0 },
            { id: 22, name: "–¢–µ—Å—Ç–æ–≤—ã–π –£—á–∞—Å—Ç–Ω–∏–∫", email: "test@example.com", login: "mat", password: "mat", role: "participant", points: 45, age: 16, registered: "2023-05-15", lastActive: "–°–µ–π—á–∞—Å", events: 5 }
        ];
        
        syncData.ourPosts = INITIAL_POSTS;
        
        syncData.tasks = [
            {
                id: 1,
                title: "–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —Å—É–±–±–æ—Ç–Ω–∏–∫—É",
                description: "–û—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å —Å–±–æ—Ä –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è –¥–ª—è —Å—É–±–±–æ—Ç–Ω–∏–∫–∞: –≥—Ä–∞–±–ª–∏, –º–µ—Ç–ª—ã, –º–µ—à–∫–∏ –¥–ª—è –º—É—Å–æ—Ä–∞",
                assignee: "all",
                deadline: "2024-01-15",
                points: 15,
                status: "assigned",
                created: Date.now()
            },
            {
                id: 2,
                title: "–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞–Ω–∞ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π",
                description: "–°–æ—Å—Ç–∞–≤–∏—Ç—å –ø–ª–∞–Ω –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π –Ω–∞ —è–Ω–≤–∞—Ä—å —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –¥–∞—Ç –∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö",
                assignee: "–£—Å–º–∞–Ω–æ–≤ –ú–∞—Ç–≤–µ–π",
                deadline: "2024-01-10",
                points: 20,
                status: "assigned",
                created: Date.now() - 86400000
            },
            {
                id: 3,
                title: "–§–æ—Ç–æ–æ—Ç—á–µ—Ç —Å –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π",
                description: "–°–æ–±—Ä–∞—Ç—å –∏ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ —Å –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π –æ—Ç—Ä—è–¥–∞",
                assignee: "–ë–µ–ª–∏–∫–æ–≤–∞ –ö–∞—Ç—è",
                deadline: "2024-01-08",
                points: 10,
                status: "completed",
                created: Date.now() - 172800000
            }
        ];
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
        saveToLocalStorage();
    }
    
    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –¥–∞—Ç—É –¥–ª—è –¥–µ–¥–ª–∞–π–Ω–∞ –∑–∞–¥–∞—á
    const deadlineInput = document.getElementById('taskDeadline');
    if (deadlineInput) {
        const today = new Date().toISOString().split('T')[0];
        deadlineInput.min = today;
        
        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –Ω–∞ –∑–∞–≤—Ç—Ä–∞
        const tomorrow = new Date();
        tomorrow.setDate(tomorrow.getDate() + 1);
        deadlineInput.value = tomorrow.toISOString().split('T')[0];
    }
}

// –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ localStorage
function loadFromLocalStorage() {
    try {
        const saved = localStorage.getItem(SYNC_CONFIG.storageKey);
        if (saved) {
            const parsed = JSON.parse(saved);
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ä–æ–∫ –≥–æ–¥–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
            if (parsed.expiry && parsed.expiry > Date.now()) {
                syncData = parsed.data;
                syncState.lastSynced = parsed.timestamp;
                console.log('–î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ –∫—ç—à–∞');
                return true;
            } else {
                console.log('–ö—ç—à —É—Å—Ç–∞—Ä–µ–ª, –æ—á–∏—â–∞–µ–º');
                localStorage.removeItem(SYNC_CONFIG.storageKey);
            }
        }
    } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑ –∫—ç—à–∞:', error);
    }
    return false;
}

// –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ localStorage
function saveToLocalStorage(force = false) {
    if (syncState.isSyncing && !force) return;
    
    try {
        const dataToSave = {
            data: syncData,
            timestamp: Date.now(),
            expiry: Date.now() + SYNC_CONFIG.cacheTTL,
            deviceId: syncState.currentDeviceId,
            version: SYNC_CONFIG.version
        };
        
        localStorage.setItem(SYNC_CONFIG.storageKey, JSON.stringify(dataToSave));
        syncState.lastSynced = Date.now();
        
        // –û–±–Ω–æ–≤–ª—è–µ–º —Ö—ç—à –¥–∞–Ω–Ω—ã—Ö
        updateDataHash();
        
        // –ü–æ–º–µ—á–∞–µ–º, —á—Ç–æ –µ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
        syncState.pendingChanges = true;
        
        console.log('–î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –ª–æ–∫–∞–ª—å–Ω–æ');
        return true;
    } catch (error) {
        console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –∫—ç—à:', error);
        showSyncError('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö');
        return false;
    }
}

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ö—ç—à–∞ –¥–∞–Ω–Ω—ã—Ö
function updateDataHash() {
    const dataString = JSON.stringify(syncData);
    let hash = 0;
    for (let i = 0; i < dataString.length; i++) {
        hash = ((hash << 5) - hash) + dataString.charCodeAt(i);
        hash = hash & hash;
    }
    syncData.dataHash = hash.toString(36);
}

// ========== –§–£–ù–ö–¶–ò–ò –í–•–û–î–ê –ò –ê–í–¢–û–†–ò–ó–ê–¶–ò–ò ==========

// –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –º–æ–¥–∞–ª—å–Ω—ã–º–∏ –æ–∫–Ω–∞–º–∏
function showLoginModal() {
    document.getElementById('loginModal').style.display = 'block';
}

function closeLoginModal() {
    document.getElementById('loginModal').style.display = 'none';
    document.getElementById('loginError').style.display = 'none';
}

function showAdminLoginModal() {
    document.getElementById('adminLoginModal').style.display = 'block';
}

function closeAdminLoginModal() {
    document.getElementById('adminLoginModal').style.display = 'none';
    document.getElementById('adminLoginError').style.display = 'none';
}

function showComstaffLoginModal() {
    document.getElementById('comstaffLoginModal').style.display = 'block';
}

function closeComstaffLoginModal() {
    document.getElementById('comstaffLoginModal').style.display = 'none';
    document.getElementById('comstaffLoginError').style.display = 'none';
}

// –§—É–Ω–∫—Ü–∏—è –≤—Ö–æ–¥–∞ –¥–ª—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
function login() {
    const username = document.getElementById('loginUsername').value;
    const password = document.getElementById('loginPassword').value;
    
    const user = syncData.users.find(u => u.login === username && u.password === password);
    
    if (user) {
        currentUser = user;
        document.getElementById('loginModal').style.display = 'none';
        document.getElementById('userPanel').style.display = 'block';
        document.getElementById('userName').textContent = user.name;
        document.getElementById('userRole').textContent = getRoleText(user.role);
        document.getElementById('userPoints').textContent = user.points;
        document.getElementById('goodDeedsCounter').style.display = 'block';
        document.getElementById('totalDeedsMain').textContent = syncData.totalDeeds;
        
        document.getElementById('totalDeeds').textContent = syncData.totalDeeds;
        
        showNotification('–£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥!', 'success');
    } else {
        document.getElementById('loginError').textContent = '–ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å';
        document.getElementById('loginError').style.display = 'block';
    }
}

// –§—É–Ω–∫—Ü–∏—è –≤—Ö–æ–¥–∞ –¥–ª—è –∫–æ–º—Å–æ—Å—Ç–∞–≤–∞
function comstaffLogin() {
    const username = document.getElementById('comstaffLoginUsername').value;
    const password = document.getElementById('comstaffLoginPassword').value;
    
    const comstaffUser = syncData.users.find(u => 
        u.login === username && 
        u.password === password && 
        u.role === 'comstaff'
    );
    
    if (comstaffUser) {
        currentUser = comstaffUser;
        document.getElementById('comstaffLoginModal').style.display = 'none';
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–∞–ª–µ–Ω–¥–∞—Ä—å
        showComstaffCalendar();
        
        showNotification('–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –ø–∞–Ω–µ–ª—å –∫–æ–º—Å–æ—Å—Ç–∞–≤–∞! –î–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –ø–æ—Å—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Telegram –±–æ—Ç–∞ @x3_x3_x3bot', 'success');
    } else {
        document.getElementById('comstaffLoginError').textContent = '–ù–µ–≤–µ—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≤—Ö–æ–¥–∞ –∫–æ–º—Å–æ—Å—Ç–∞–≤–∞';
        document.getElementById('comstaffLoginError').style.display = 'block';
    }
}

// –§—É–Ω–∫—Ü–∏—è –≤—Ö–æ–¥–∞ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
function adminLogin() {
    const username = document.getElementById('adminLoginUsername').value;
    const password = document.getElementById('adminLoginPassword').value;
    
    const adminUser = syncData.users.find(u => u.login === username && u.password === password && (u.role === 'admin' || u.role === 'moderator'));
    
    if (adminUser) {
        currentUser = adminUser;
        document.getElementById('adminLoginModal').style.display = 'none';
        document.getElementById('mainPage').style.display = 'none';
        document.getElementById('adminPanel').style.display = 'block';
        
        showNotification('–í—Ö–æ–¥ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –≤—ã–ø–æ–ª–Ω–µ–Ω!', 'success');
    } else {
        document.getElementById('adminLoginError').textContent = '–ù–µ–≤–µ—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤';
        document.getElementById('adminLoginError').style.display = 'block';
    }
}

// –§—É–Ω–∫—Ü–∏—è –≤—ã—Ö–æ–¥–∞
function logout() {
    currentUser = null;
    document.getElementById('mainPage').style.display = 'block';
    document.getElementById('adminPanel').style.display = 'none';
    document.getElementById('comstaffPanel').style.display = 'none';
    document.getElementById('userPanel').style.display = 'none';
    document.getElementById('profileSection').style.display = 'none';
    document.getElementById('goodDeedsCounter').style.display = 'none';
    document.getElementById('tasksSection').style.display = 'none';
    
    document.getElementById('loginForm').reset();
    document.getElementById('comstaffLoginForm').reset();
    document.getElementById('adminLoginForm').reset();
    
    showNotification('–í—ã –≤—ã—à–ª–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã', 'info');
}

// ========== –§–£–ù–ö–¶–ò–ò –û–¢–û–ë–†–ê–ñ–ï–ù–ò–Ø ==========

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞ –ø—Ä–æ—Ñ–∏–ª—è
function showProfile() {
    document.getElementById('profileSection').style.display = 'block';
    document.getElementById('tasksSection').style.display = 'none';
    
    if (currentUser) {
        document.getElementById('profileName').textContent = currentUser.name;
        document.getElementById('profileEmail').textContent = currentUser.email;
        document.getElementById('profileAge').textContent = currentUser.age;
        document.getElementById('profileLogin').textContent = currentUser.login;
        document.getElementById('profilePoints').textContent = currentUser.points;
        document.getElementById('profileRole').textContent = getRoleText(currentUser.role);
        document.getElementById('profileRegistered').textContent = currentUser.registered;
        document.getElementById('profileLastActive').textContent = currentUser.lastActive;
        document.getElementById('profileEvents').textContent = currentUser.events;
        document.getElementById('totalDeeds').textContent = syncData.totalDeeds;
    }
}

// –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
function showMainPage() {
    document.getElementById('profileSection').style.display = 'none';
    document.getElementById('tasksSection').style.display = 'none';
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞ –∑–∞–¥–∞–Ω–∏–π —É—á–∞—Å—Ç–Ω–∏–∫–∞
function showMyTasks() {
    document.getElementById('profileSection').style.display = 'none';
    document.getElementById('tasksSection').style.display = 'block';
    
    loadUserTasks();
}

// –§—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–¥–∞–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
function loadUserTasks() {
    const container = document.getElementById('userTasksContainer');
    if (!container) return;
    
    if (!currentUser) {
        container.innerHTML = '<div class="no-tasks">–í–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –∑–∞–¥–∞–Ω–∏—è</div>';
        return;
    }
    
    const userTasks = syncData.tasks.filter(task => 
        task.assignee === currentUser.name || task.assignee === 'all'
    );
    
    if (userTasks.length === 0) {
        container.innerHTML = '<div class="no-tasks">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–¥–∞–Ω–∏–π</div>';
        return;
    }
    
    container.innerHTML = '';
    
    userTasks.forEach(task => {
        const taskCard = document.createElement('div');
        taskCard.className = 'task-card';
        
        const isOverdue = new Date(task.deadline) < new Date();
        
        taskCard.innerHTML = `
            <div class="task-header">
                <div class="task-title">${task.title}</div>
                <div class="task-deadline ${isOverdue ? 'overdue' : ''}">üìÖ ${task.deadline}</div>
            </div>
            <p>${task.description}</p>
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <div>
                    <span class="task-points">üèÜ ${task.points} –±–∞–ª–ª–æ–≤</span>
                    <span class="task-status-badge status-${task.status}">${getStatusText(task.status)}</span>
                </div>
                ${task.status !== 'completed' ? 
                    `<button class="complete-task-btn" onclick="completeTask(${task.id})">–í—ã–ø–æ–ª–Ω–∏—Ç—å</button>` : 
                    ''
                }
            </div>
        `;
        
        container.appendChild(taskCard);
    });
}

// ========== –£–ü–†–ê–í–õ–ï–ù–ò–ï –ù–ê–®–ò–ú–ò –ü–û–°–¢–ê–ú–ò ==========

// –§—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ—Å—Ç–∞
function createPost() {
    const title = document.getElementById('postTitle').value;
    const content = document.getElementById('postContent').value;
    
    if (!title || !content) {
        showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∏ —Ç–µ–∫—Å—Ç –ø–æ—Å—Ç–∞!', 'error');
        return;
    }
    
    const newPost = {
        id: Date.now(),
        title: title,
        content: content,
        date: new Date().toISOString().split('T')[0],
        image: '',
        created: Date.now(),
        createdBy: currentUser ? currentUser.name : '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä'
    };
    
    syncData.ourPosts.unshift(newPost);
    
    showNotification('–ü–æ—Å—Ç —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω!', 'success');
    
    saveToLocalStorage();
    
    document.getElementById('createPostForm').reset();
    document.getElementById('multipleImagePreview').innerHTML = '';
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ—Å—Ç–æ–≤
    updateOurPosts();
}

// –§—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–∞—à–∏—Ö –ø–æ—Å—Ç–æ–≤
function updateOurPosts() {
    const postsContainer = document.getElementById('ourPostsContainer');
    if (!postsContainer) return;
    
    postsContainer.innerHTML = '';
    
    if (syncData.ourPosts.length === 0) {
        postsContainer.innerHTML = '<div class="no-posts">–ü–æ–∫–∞ –Ω–µ—Ç –Ω–æ–≤–æ—Å—Ç–µ–π. –°–ª–µ–¥–∏—Ç–µ –∑–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏!</div>';
    } else {
        syncData.ourPosts.forEach(post => {
            const postElement = document.createElement('div');
            postElement.className = 'post';
            postElement.innerHTML = `
                <div class="post-header">
                    <div class="post-title">${post.title}</div>
                    <div class="post-date">${post.date}</div>
                </div>
                ${post.image ? `<img src="${post.image}" class="post-image" alt="${post.title}">` : ''}
                <div class="post-content">${formatPostContent(post.content)}</div>
                ${currentUser && (currentUser.role === 'admin' || currentUser.role === 'comstaff') ? `
                    <div style="margin-top: 15px; text-align: right;">
                        <button class="delete-btn" onclick="deleteOurPost(${post.id})">
                            –£–¥–∞–ª–∏—Ç—å –ø–æ—Å—Ç
                        </button>
                    </div>
                ` : ''}
            `;
            postsContainer.appendChild(postElement);
        });
    }
    
    document.getElementById('ourLastUpdate').textContent = `–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: ${new Date().toLocaleTimeString()}`;
}

// –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –ø–æ—Å—Ç–∞ –Ω–∞ –∞–±–∑–∞—Ü—ã
function formatPostContent(content) {
    const paragraphs = content.split('\n\n');
    let formatted = '';
    
    paragraphs.forEach(paragraph => {
        if (paragraph.trim()) {
            formatted += `<div class="post-paragraph">${paragraph.replace(/\n/g, '<br>')}</div>`;
        }
    });
    
    return formatted;
}

// –§—É–Ω–∫—Ü–∏—è —É–¥–∞–ª–µ–Ω–∏—è –ø–æ—Å—Ç–∞
function deleteOurPost(postId) {
    if (!confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –ø–æ—Å—Ç?')) return;
    
    const postIndex = syncData.ourPosts.findIndex(post => post.id === postId);
    if (postIndex !== -1) {
        syncData.ourPosts.splice(postIndex, 1);
        saveToLocalStorage();
        updateOurPosts();
        showNotification('–ü–æ—Å—Ç —É–¥–∞–ª–µ–Ω!', 'success');
    }
}

// ========== –£–ü–†–ê–í–õ–ï–ù–ò–ï –ó–ê–î–ê–ù–ò–Ø–ú–ò ==========

// –§—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞—á–∏
function createTask() {
    const title = document.getElementById('taskTitle').value;
    const description = document.getElementById('taskDescription').value;
    const assignee = document.getElementById('taskAssignee').value;
    const deadline = document.getElementById('taskDeadline').value;
    const points = parseInt(document.getElementById('taskPoints').value);
    
    if (!title || !description || !deadline) {
        showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è!', 'error');
        return;
    }
    
    const newTask = {
        id: Date.now(),
        title: title,
        description: description,
        assignee: assignee,
        deadline: deadline,
        points: points,
        status: 'assigned',
        created: Date.now(),
        createdBy: currentUser.name
    };
    
    syncData.tasks.unshift(newTask);
    
    showNotification('–ó–∞–¥–∞—á–∞ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–∞!', 'success');
    
    saveToLocalStorage();
    
    document.getElementById('createTaskForm').reset();
    document.getElementById('taskPoints').value = 10;
    
    const tomorrow = new Date();
    tomorrow.setDate(tomorrow.getDate() + 1);
    document.getElementById('taskDeadline').value = tomorrow.toISOString().split('T')[0];
    
    loadActiveTasks();
}

// –§—É–Ω–∫—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏
function completeTask(taskId) {
    const task = syncData.tasks.find(t => t.id === taskId);
    if (!task) return;
    
    task.status = 'completed';
    
    // –ù–∞—á–∏—Å–ª—è–µ–º –±–∞–ª–ª—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
    if (currentUser) {
        const user = syncData.users.find(u => u.id === currentUser.id);
        if (user) {
            user.points = (user.points || 0) + (task.points || 0);
            syncData.totalDeeds += task.points || 0;
        }
    }
    
    saveToLocalStorage();
    loadUserTasks();
    showNotification('–ó–∞–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ! –ë–∞–ª–ª—ã –Ω–∞—á–∏—Å–ª–µ–Ω—ã.', 'success');
}

// –§—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–¥–∞—á
function loadActiveTasks() {
    const container = document.getElementById('activeTasksList');
    if (!container) return;
    
    const activeTasks = syncData.tasks.filter(task => task.status !== 'completed');
    
    if (activeTasks.length === 0) {
        container.innerHTML = '<div class="no-tasks">–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–¥–∞—á</div>';
        return;
    }
    
    container.innerHTML = '';
    
    activeTasks.forEach(task => {
        const taskDiv = document.createElement('div');
        taskDiv.className = 'task-item';
        
        const isOverdue = new Date(task.deadline) < new Date();
        
        taskDiv.innerHTML = `
            <div>
                <strong>${task.title}</strong>
                <p>${task.description}</p>
                <div style="margin-top: 10px;">
                    <span>–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å: ${task.assignee}</span>
                    <span style="margin-left: 15px;" class="${isOverdue ? 'overdue' : ''}">
                        üìÖ ${task.deadline}
                    </span>
                    <span class="task-status status-${task.status}">${getStatusText(task.status)}</span>
                </div>
            </div>
            <div style="text-align: right;">
                <div style="font-weight: bold; color: #4caf50;">üèÜ ${task.points}</div>
                <button class="delete-btn" onclick="deleteTask(${task.id})" style="margin-top: 5px;">–£–¥–∞–ª–∏—Ç—å</button>
            </div>
        `;
        
        container.appendChild(taskDiv);
    });
}

// –§—É–Ω–∫—Ü–∏—è —É–¥–∞–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∏
function deleteTask(taskId) {
    if (!confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç—É –∑–∞–¥–∞—á—É?')) return;
    
    const taskIndex = syncData.tasks.findIndex(task => task.id === taskId);
    if (taskIndex !== -1) {
        syncData.tasks.splice(taskIndex, 1);
        saveToLocalStorage();
        loadActiveTasks();
        showNotification('–ó–∞–¥–∞—á–∞ —É–¥–∞–ª–µ–Ω–∞', 'success');
    }
}

// ========== –§–£–ù–ö–¶–ò–ò –ö–ê–õ–ï–ù–î–ê–†–Ø ==========

function showComstaffCalendar() {
    document.getElementById('comstaffCalendarModal').style.display = 'block';
    renderCalendar();
}

function closeComstaffCalendar() {
    document.getElementById('comstaffCalendarModal').style.display = 'none';
}

function renderCalendar() {
    const monthYear = document.getElementById('currentMonthYear');
    const calendarGrid = document.getElementById('calendarDays');
    
    const monthNames = [
        '–Ø–Ω–≤–∞—Ä—å', '–§–µ–≤—Ä–∞–ª—å', '–ú–∞—Ä—Ç', '–ê–ø—Ä–µ–ª—å', '–ú–∞–π', '–ò—é–Ω—å',
        '–ò—é–ª—å', '–ê–≤–≥—É—Å—Ç', '–°–µ–Ω—Ç—è–±—Ä—å', '–û–∫—Ç—è–±—Ä—å', '–ù–æ—è–±—Ä—å', '–î–µ–∫–∞–±—Ä—å'
    ];
    
    monthYear.textContent = `${monthNames[currentCalendarDate.getMonth()]} ${currentCalendarDate.getFullYear()}`;
    
    calendarGrid.innerHTML = '';
    
    // –ó–∞–≥–æ–ª–æ–≤–∫–∏ –¥–Ω–µ–π –Ω–µ–¥–µ–ª–∏
    const dayNames = ['–ü–Ω', '–í—Ç', '–°—Ä', '–ß—Ç', '–ü—Ç', '–°–±', '–í—Å'];
    dayNames.forEach(day => {
        const dayHeader = document.createElement('div');
        dayHeader.className = 'calendar-day-header';
        dayHeader.textContent = day;
        calendarGrid.appendChild(dayHeader);
    });
    
    const firstDay = new Date(currentCalendarDate.getFullYear(), currentCalendarDate.getMonth(), 1);
    const lastDay = new Date(currentCalendarDate.getFullYear(), currentCalendarDate.getMonth() + 1, 0);
    
    const firstDayOfWeek = firstDay.getDay() === 0 ? 6 : firstDay.getDay() - 1;
    
    // –ü—É—Å—Ç—ã–µ –¥–Ω–∏ –≤ –Ω–∞—á–∞–ª–µ –º–µ—Å—è—Ü–∞
    for (let i = 0; i < firstDayOfWeek; i++) {
        const emptyDay = document.createElement('div');
        emptyDay.className = 'calendar-day other-month';
        emptyDay.textContent = '';
        calendarGrid.appendChild(emptyDay);
    }
    
    // –î–Ω–∏ –º–µ—Å—è—Ü–∞
    const today = new Date();
    for (let day = 1; day <= lastDay.getDate(); day++) {
        const dayElement = document.createElement('div');
        dayElement.className = 'calendar-day';
        dayElement.textContent = day;
        
        const currentDate = new Date(currentCalendarDate.getFullYear(), currentCalendarDate.getMonth(), day);
        
        // –û—Ç–º–µ—á–∞–µ–º —Å–µ–≥–æ–¥–Ω—è—à–Ω–∏–π –¥–µ–Ω—å
        if (currentDate.toDateString() === today.toDateString()) {
            dayElement.classList.add('today');
        }
        
        // –û—Ç–º–µ—á–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é –¥–∞—Ç—É
        if (selectedCalendarDate && 
            currentDate.toDateString() === selectedCalendarDate.toDateString()) {
            dayElement.classList.add('selected');
        }
        
        dayElement.onclick = function() {
            selectedCalendarDate = new Date(currentCalendarDate.getFullYear(), currentCalendarDate.getMonth(), day);
            renderCalendar();
        };
        
        calendarGrid.appendChild(dayElement);
    }
}

function changeMonth(delta) {
    currentCalendarDate.setMonth(currentCalendarDate.getMonth() + delta);
    renderCalendar();
}

function confirmCalendarSelection() {
    if (selectedCalendarDate) {
        const formattedDate = selectedCalendarDate.toLocaleDateString('ru-RU');
        showNotification(`–í—ã–±—Ä–∞–Ω–∞ –¥–∞—Ç–∞: ${formattedDate}. –û—Ç–∫—Ä—ã–≤–∞—é –ø–∞–Ω–µ–ª—å –∫–æ–º—Å–æ—Å—Ç–∞–≤–∞...`, 'success');
        
        setTimeout(() => {
            closeComstaffCalendar();
            document.getElementById('mainPage').style.display = 'none';
            document.getElementById('comstaffPanel').style.display = 'block';
            document.getElementById('comstaffUserName').textContent = currentUser.name;
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∫–æ–º—Å–æ—Å—Ç–∞–≤–∞
            loadComstaffData();
        }, 1500);
    } else {
        showNotification('–í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ', 'error');
    }
}

// ========== –§–£–ù–ö–¶–ò–ò –î–õ–Ø –ü–ê–ù–ï–õ–ò –ö–û–ú–°–û–°–¢–ê–í–ê ==========

function showComstaffSection(sectionName) {
    // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Å–µ–∫—Ü–∏–∏
    document.querySelectorAll('.comstaff-section').forEach(section => {
        section.classList.remove('active');
    });
    
    // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å–æ –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
    document.querySelectorAll('#comstaffPanel .nav-user-btn').forEach(btn => {
        btn.classList.remove('active');
    });
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é —Å–µ–∫—Ü–∏—é
    const section = document.getElementById(`comstaff${sectionName.charAt(0).toUpperCase() + sectionName.slice(1)}Section`);
    if (section) {
        section.classList.add('active');
    }
    
    // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å –∫ –∫–Ω–æ–ø–∫–µ
    event.target.classList.add('active');
    
    // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Å–µ–∫—Ü–∏–∏
    switch(sectionName) {
        case 'stats':
            loadComstaffStats();
            break;
        case 'members':
            loadComstaffMembers();
            break;
        case 'points':
            loadComstaffPointsData();
            break;
        case 'tasks':
            loadComstaffTasks();
            break;
    }
}

function loadComstaffData() {
    loadComstaffStats();
    loadComstaffMembers();
    loadComstaffPointsData();
    loadComstaffTasks();
}

function loadComstaffStats() {
    // –†–∞—Å—á–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
    const totalMembers = syncData.users.filter(u => u.role === 'participant').length;
    const activeMembers = syncData.users.filter(u => u.role === 'participant' && u.lastActive === '–°–µ–π—á–∞—Å').length;
    const totalPoints = syncData.users.reduce((sum, user) => sum + (user.points || 0), 0);
    const avgPoints = totalMembers > 0 ? Math.round(totalPoints / totalMembers) : 0;
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
    document.getElementById('comstaffTotalMembers').textContent = totalMembers;
    document.getElementById('comstaffActiveMembers').textContent = activeMembers;
    document.getElementById('comstaffTotalPoints').textContent = totalPoints;
    document.getElementById('comstaffAvgPoints').textContent = avgPoints;
    
    // –ó–∞–≥—Ä—É–∑–∫–∞ –ª—É—á—à–∏—Ö –±–æ–π—Ü–æ–≤
    loadTopMembers();
}

function loadTopMembers() {
    const participants = syncData.users
        .filter(u => u.role === 'participant')
        .sort((a, b) => (b.points || 0) - (a.points || 0))
        .slice(0, 5);
    
    const container = document.getElementById('topMembersList');
    if (!container) return;
    
    container.innerHTML = '';
    
    if (participants.length === 0) {
        container.innerHTML = '<div class="no-tasks">–ü–æ–∫–∞ –Ω–µ—Ç —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</div>';
        return;
    }
    
    participants.forEach((user, index) => {
        const memberDiv = document.createElement('div');
        memberDiv.className = 'member-item';
        if (user.login === 'usmanov') {
            memberDiv.classList.add('usmanov-highlight');
        }
        
        const medal = index === 0 ? 'ü•á' : index === 1 ? 'ü•à' : index === 2 ? 'ü•â' : 'üèÖ';
        
        memberDiv.innerHTML = `
            <div>
                <strong>${medal} ${user.name}</strong>
                <div style="font-size: 0.9em; color: #666;">–õ–æ–≥–∏–Ω: ${user.login}</div>
            </div>
            <div>
                <span class="member-points">${user.points || 0} –±–∞–ª–ª–æ–≤</span>
                ${user.login === 'usmanov' ? '<span class="usmanov-badge">–¢–û–ü</span>' : ''}
            </div>
        `;
        
        container.appendChild(memberDiv);
    });
}

function loadComstaffMembers() {
    const participants = syncData.users.filter(u => u.role === 'participant');
    const container = document.getElementById('comstaffMembersList');
    
    if (!container) return;
    
    container.innerHTML = '';
    
    participants.forEach(user => {
        const memberDiv = document.createElement('div');
        memberDiv.className = 'member-item';
        if (user.login === 'usmanov') {
            memberDiv.classList.add('usmanov-highlight');
        }
        
        memberDiv.innerHTML = `
            <div>
                <strong>${user.name}</strong>
                <div style="font-size: 0.9em; color: #666;">
                    –õ–æ–≥–∏–Ω: ${user.login} | –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å: ${user.lastActive}
                </div>
            </div>
            <div>
                <span class="member-points">${user.points || 0} –±–∞–ª–ª–æ–≤</span>
                ${user.login === 'usmanov' ? '<span class="usmanov-badge">–¢–û–ü</span>' : ''}
            </div>
        `;
        
        container.appendChild(memberDiv);
    });
}

function searchMembers() {
    const searchTerm = document.getElementById('memberSearch').value.toLowerCase();
    const members = document.querySelectorAll('#comstaffMembersList .member-item');
    
    members.forEach(member => {
        const name = member.querySelector('strong').textContent.toLowerCase();
        const login = member.querySelector('div div').textContent.toLowerCase();
        
        if (name.includes(searchTerm) || login.includes(searchTerm)) {
            member.style.display = 'flex';
        } else {
            member.style.display = 'none';
        }
    });
}

function loadComstaffPointsData() {
    // –ó–∞–ø–æ–ª–Ω—è–µ–º –≤—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    const select = document.getElementById('comstaffPointsUserSelect');
    if (select) {
        select.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –±–æ–π—Ü–∞</option>';
        
        syncData.users.filter(u => u.role === 'participant').forEach(user => {
            const option = document.createElement('option');
            option.value = user.id;
            option.textContent = `${user.name} (${user.points || 0} –±–∞–ª–ª–æ–≤)`;
            select.appendChild(option);
        });
    }
    
    // –ó–∞–≥—Ä—É–∂–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é –æ–ø–µ—Ä–∞—Ü–∏–π
    loadComstaffPointsHistory();
}

function loadComstaffPointsHistory() {
    const container = document.getElementById('comstaffPointsHistory');
    if (!container) return;
    
    // –ë–µ—Ä–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ 10 –æ–ø–µ—Ä–∞—Ü–∏–π
    const recentHistory = syncData.pointsHistory.slice(-10).reverse();
    
    if (recentHistory.length === 0) {
        container.innerHTML = '<div class="no-tasks">–ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π –ø—É—Å—Ç–∞</div>';
        return;
    }
    
    container.innerHTML = '';
    
    recentHistory.forEach(record => {
        const historyItem = document.createElement('div');
        historyItem.className = 'task-item';
        
        const user = syncData.users.find(u => u.id === record.userId);
        const userName = user ? user.name : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å';
        
        historyItem.innerHTML = `
            <div>
                <strong>${userName}</strong>
                <div style="margin-top: 5px;">
                    <span>${record.reason}</span>
                    <span style="margin-left: 15px; font-weight: bold; color: ${record.amount > 0 ? '#4caf50' : '#f44336'}">
                        ${record.amount > 0 ? '+' : ''}${record.amount} –±–∞–ª–ª–æ–≤
                    </span>
                </div>
                <div style="font-size: 0.8em; color: #888; margin-top: 5px;">
                    ${new Date(record.date).toLocaleString()}
                </div>
            </div>
        `;
        
        container.appendChild(historyItem);
    });
}

function comstaffAddPoints() {
    const userId = parseInt(document.getElementById('comstaffPointsUserSelect').value);
    const amount = parseInt(document.getElementById('comstaffPointsAmount').value);
    const reason = document.getElementById('comstaffPointsReason').value;
    const comment = document.getElementById('comstaffPointsComment').value;
    
    if (!userId || !amount || !reason) {
        showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è!', 'error');
        return;
    }
    
    const user = syncData.users.find(u => u.id === userId);
    if (!user) {
        showNotification('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω', 'error');
        return;
    }
    
    // –î–æ–±–∞–≤–ª—è–µ–º –±–∞–ª–ª—ã
    user.points = (user.points || 0) + amount;
    syncData.totalDeeds += amount;
    
    // –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–ø–∏—Å—å –≤ –∏—Å—Ç–æ—Ä–∏—é
    syncData.pointsHistory.push({
        userId: userId,
        amount: amount,
        reason: reason + (comment ? ` (${comment})` : ''),
        date: Date.now(),
        by: currentUser.name
    });
    
    saveToLocalStorage();
    
    showNotification(`–ù–∞—á–∏—Å–ª–µ–Ω–æ ${amount} –±–∞–ª–ª–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é ${user.name}`, 'success');
    
    // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
    document.getElementById('comstaffPointsComment').value = '';
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ
    loadComstaffPointsData();
    loadComstaffStats();
}

function comstaffRemovePoints() {
    const userId = parseInt(document.getElementById('comstaffPointsUserSelect').value);
    const amount = parseInt(document.getElementById('comstaffPointsAmount').value);
    const reason = document.getElementById('comstaffPointsReason').value;
    const comment = document.getElementById('comstaffPointsComment').value;
    
    if (!userId || !amount || !reason) {
        showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è!', 'error');
        return;
    }
    
    const user = syncData.users.find(u => u.id === userId);
    if (!user) {
        showNotification('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω', 'error');
        return;
    }
    
    if ((user.points || 0) < amount) {
        showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–∞–ª–ª–æ–≤ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', 'error');
        return;
    }
    
    // –£–±–∏—Ä–∞–µ–º –±–∞–ª–ª—ã
    user.points = (user.points || 0) - amount;
    syncData.totalDeeds = Math.max(0, syncData.totalDeeds - amount);
    
    // –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–ø–∏—Å—å –≤ –∏—Å—Ç–æ—Ä–∏—é
    syncData.pointsHistory.push({
        userId: userId,
        amount: -amount,
        reason: reason + (comment ? ` (${comment})` : ''),
        date: Date.now(),
        by: currentUser.name
    });
    
    saveToLocalStorage();
    
    showNotification(`–°–ø–∏—Å–∞–Ω–æ ${amount} –±–∞–ª–ª–æ–≤ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ${user.name}`, 'success');
    
    // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
    document.getElementById('comstaffPointsComment').value = '';
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ
    loadComstaffPointsData();
    loadComstaffStats();
}

function loadComstaffTasks() {
    loadActiveTasks();
    
    // –ó–∞–ø–æ–ª–Ω—è–µ–º —Å–ø–∏—Å–æ–∫ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π
    const assigneeSelect = document.getElementById('taskAssignee');
    if (assigneeSelect) {
        assigneeSelect.innerHTML = '<option value="all">–í—Å–µ –±–æ–π—Ü—ã</option>';
        
        syncData.users.filter(u => u.role === 'participant').forEach(user => {
            const option = document.createElement('option');
            option.value = user.name;
            option.textContent = user.name;
            assigneeSelect.appendChild(option);
        });
    }
}

function createQuickTask() {
    showComstaffSection('tasks');
    document.getElementById('taskTitle').focus();
}

// –§—É–Ω–∫—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∏—è —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ WordPress
function showWordpressEditor() {
    if (confirm('–û—Ç–∫—Ä—ã—Ç—å —Ä–µ–¥–∞–∫—Ç–æ—Ä WordPress –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ—Å—Ç–∞?')) {
        window.open('<?php echo admin_url("post-new.php"); ?>', '_blank');
    }
}

// ========== –ê–î–ú–ò–ù –§–£–ù–ö–¶–ò–ò ==========

function showAdminSection(sectionName) {
    // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Å–µ–∫—Ü–∏–∏
    document.querySelectorAll('.admin-section').forEach(section => {
        section.classList.remove('active');
    });
    
    // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å–æ –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
    document.querySelectorAll('#adminPanel .nav-btn').forEach(btn => {
        btn.classList.remove('active');
    });
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é —Å–µ–∫—Ü–∏—é
    const section = document.getElementById(`admin${sectionName.charAt(0).toUpperCase() + sectionName.slice(1)}Section`);
    if (section) {
        section.classList.add('active');
    }
    
    // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å –∫ –∫–Ω–æ–ø–∫–µ
    event.target.classList.add('active');
}

// ========== –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò ==========

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ —Ä–æ–ª–∏
function getRoleText(role) {
    switch(role) {
        case 'admin': return '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä';
        case 'moderator': return '–ú–æ–¥–µ—Ä–∞—Ç–æ—Ä';
        case 'comstaff': return '–ö–æ–º—Å–æ—Å—Ç–∞–≤';
        case 'participant': return '–£—á–∞—Å—Ç–Ω–∏–∫';
        case 'system': return '–°–∏—Å—Ç–µ–º–∞';
        default: return '–ì–æ—Å—Ç—å';
    }
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ —Å—Ç–∞—Ç—É—Å–∞
function getStatusText(status) {
    switch(status) {
        case 'assigned': return '–ù–∞–∑–Ω–∞—á–µ–Ω–æ';
        case 'completed': return '–í—ã–ø–æ–ª–Ω–µ–Ω–æ';
        case 'inprogress': return '–í —Ä–∞–±–æ—Ç–µ';
        default: return status;
    }
}

// –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
function showNotification(message, type) {
    const notification = document.createElement('div');
    notification.className = 'notification';
    notification.textContent = message;
    
    if (type === 'success') {
        notification.style.background = '#4caf50';
    } else if (type === 'error') {
        notification.style.background = '#f44336';
    } else {
        notification.style.background = '#2196f3';
    }
    
    document.body.appendChild(notification);
    
    setTimeout(() => {
        notification.style.opacity = '0';
        setTimeout(() => {
            document.body.removeChild(notification);
        }, 300);
    }, 3000);
}

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
function updateUI() {
    // –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–∞—à–∏ –ø–æ—Å—Ç—ã
    updateOurPosts();
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ –¥–æ–±—Ä—ã—Ö –¥–µ–ª
    document.getElementById('totalDeeds').textContent = syncData.totalDeeds;
    document.getElementById('totalDeedsMain').textContent = syncData.totalDeeds;
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
window.onload = function() {
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ
    initializeData();
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
    updateUI();
    
    console.log('–°–∏—Å—Ç–µ–º–∞ –∑–∞–ø—É—â–µ–Ω–∞');
    
    // –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
    const imageInput = document.getElementById('postImage');
    if (imageInput) {
        imageInput.addEventListener('change', function(e) {
            const previewContainer = document.getElementById('multipleImagePreview');
            previewContainer.innerHTML = '';
            
            Array.from(e.target.files).forEach((file, index) => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = document.createElement('img');
                    img.src = e.target.result;
                    img.style.maxWidth = '100px';
                    img.style.maxHeight = '100px';
                    img.style.margin = '5px';
                    img.style.borderRadius = '8px';
                    img.title = `–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ ${index + 1}`;
                    previewContainer.appendChild(img);
                };
                reader.readAsDataURL(file);
            });
        });
    }
    
    // –ó–∞–ø—É—Å–∫–∞–µ–º –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
    setInterval(() => {
        if (syncState.pendingChanges) {
            saveToLocalStorage();
        }
    }, 30000); // –ö–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
};

// –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
function saveAllChanges() {
    saveToLocalStorage();
    showNotification('–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!', 'success');
}

function savePosts() {
    saveToLocalStorage();
    showNotification('–ü–æ—Å—Ç—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!', 'success');
}

function saveUsers() {
    saveToLocalStorage();
    showNotification('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!', 'success');
}

function savePoints() {
    saveToLocalStorage();
    showNotification('–ë–∞–ª–ª—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!', 'success');
}

function registerUser() {
    const name = document.getElementById('newUserName').value;
    const email = document.getElementById('newUserEmail').value;
    const login = document.getElementById('newUserLogin').value;
    const password = document.getElementById('newUserPassword').value;
    const role = document.getElementById('newUserRole').value;
    
    if (!name || !email || !login || !password || !role) {
        showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è!', 'error');
        return;
    }
    
    const newUser = {
        id: Date.now(),
        name: name,
        email: email,
        login: login,
        password: password,
        role: role,
        points: 0,
        age: '–Ω–µ –∏–∑–≤–µ—Å—Ç–Ω–æ',
        registered: new Date().toISOString().split('T')[0],
        lastActive: '–ù–∏–∫–æ–≥–¥–∞',
        events: 0
    };
    
    syncData.users.push(newUser);
    saveToLocalStorage();
    
    showNotification(`–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ${name} –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω!`, 'success');
    
    // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
    document.getElementById('registerUserForm').reset();
}

function addPoints() {
    showNotification('–§—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ', 'info');
}

function removePoints() {
    showNotification('–§—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ', 'info');
}
</script>
</body>
</html>